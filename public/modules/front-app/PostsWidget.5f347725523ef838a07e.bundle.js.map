{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./resources/modules/editor/src/js/components/altrp-posts/components/PostsWrapper.js","webpack:///./resources/modules/editor/src/js/components/altrp-posts/altrp-posts.js","webpack:///./resources/modules/editor/src/js/components/widgets/PostsWidget.js","webpack:///./node_modules/react-select/async/dist/react-select.browser.esm.js"],"names":["_setPrototypeOf","o","p","Object","setPrototypeOf","__proto__","styled","columnsCount","posts_columns_gap","posts_rows_gap","styles","Number","AltrpPosts","props","renderPost","idx","hoverTemplateId","_","get","settings","transitionType","post","cloneDeep","data","PostContentComponent","component","state","simpleTemplate","postsComponents","template","frontElementsFabric","setCardModel","AltrpModel","React","componentClass","element","ElementWrapper","children","set","key","id","altrpIndex","className","simpleTemplateId","currentPage","this","setState","templateLoader","nextProps","nextState","isEditor","isEqual","prevProps","newSimpleTemplateId","posts","posts_per_page","getResponsiveSetting","Math","ceil","length","page","getPageCount","posts_pagination_type","pageCount","hide_pagination_select","hide_page_input","paginationProps","pageIndex","nextPage","setPage","previousPage","gotoPage","pageSize","widgetId","getId","Pagination","disabled","onClick","posts_prev_text","renderAssetIcon","prev_icon","posts_next_text","next_icon","hide_pre_page_button","dangerouslySetInnerHTML","__html","prev_text","hide_pages_buttons_button","pageText","hide_next_page_button","next_text","isArray","isObject","postsStart","slice","map","renderPagination","choose_datasource","Array","from","setAltrpIndex","getSettings","window","elementDecorator","baseRender","render","query","modelName","dataSource","currentModel","getProperty","Query","table_query","showPosts","getFromModel","modelData","path","replace","getDataByPath","getCurrentModel","getData","Component","SelectComponent","_class","_temp","SelectState","m","S","Async","_Component","Derived","hasNativeReflectConstruct","_super","Reflect","construct","sham","Proxy","Date","prototype","toString","call","e","_isNativeReflectConstruct","result","Super","NewTarget","constructor","arguments","apply","_this","select","lastRequest","mounted","optionsCache","handleInputChange","newValue","actionMeta","_this$props","cacheOptions","onInputChange","inputValue","loadedInputValue","loadedOptions","isLoading","passEmptyOptions","request","loadOptions","options","defaultOptions","undefined","value","_this2","focus","blur","callback","loader","then","_this3","_this$props2","isLoadingProp","_this$state","ref","_ref","defaultProps","filterOption"],"mappings":"2FAAe,SAASA,EAAgBC,EAAGC,GAMzC,OALAF,EAAkBG,OAAOC,gBAAkB,SAAyBH,EAAGC,GAErE,OADAD,EAAEI,UAAYH,EACPD,IAGcA,EAAGC,G,oUCe5B,E,SAnBqBI,OAAH,kGACgB,qBAAEC,gBAEhC,YAAwC,IAAtCC,EAAsC,EAAtCA,kBAAmBC,EAAmB,EAAnBA,eACjBC,EAAS,GAWb,OAVGF,IAAuBG,OAAOH,GAC/BE,GAAU,mBAAJ,OAAuBF,EAAvB,KACEG,OAAOH,KACfE,GAAU,mBAAJ,OAAuBF,EAAvB,QAELC,IAAoBE,OAAOF,GAC5BC,GAAU,gBAAJ,OAAoBD,EAApB,KACEE,OAAOF,KACfC,GAAU,gBAAJ,OAAoBD,EAApB,QAEDC,K,glBChBX,+BACA,gC,IAUME,E,4cACJ,WAAYC,GAAO,6BACjB,cAAMA,IAgFRC,WAAa,SAACC,GACZ,IAAMC,EAAkBC,EAAEC,IAAI,EAAKL,MAAMM,SAAU,4BAA6B,MAC1EC,EAAiBH,EAAEC,IAAI,EAAKL,MAAMM,SAAU,wBAAyB,MACvEE,EAAOJ,EAAEK,UAAU,EAAKT,MAAMU,KAAKR,IAAQ,EAAKF,MAAMU,MACtDC,EAAuBH,EAAKI,WAAa,GAC7C,GAAG,EAAKC,MAAMC,iBAAoBV,EAAEC,IAAI,EAAKU,gBAAX,UAA+B,EAAKF,MAAMC,eAA1C,YAA4DZ,IAAO,CACnG,IAAIc,EAAWC,uBAAiC,EAAKJ,MAAMC,gBAC3DE,EAASE,aAAa,IAAIC,IAAWX,GAAON,GAC5CS,EAAuBS,gBAAoBJ,EAASK,eAClD,CACEC,QAASN,EACTO,eAAgBA,UAChBC,SAAUR,EAASQ,WAEvBpB,EAAEqB,IAAI,EAAKV,gBAAX,UAA+B,EAAKF,MAAMC,eAA1C,YAA4DZ,GAAOS,QAC3DP,EAAEC,IAAI,EAAKU,gBAAX,UAA+B,EAAKF,MAAMC,eAA1C,YAA4DZ,MACpES,EAAuBP,EAAEC,IAAI,EAAKU,gBAAX,UAA+B,EAAKF,MAAMC,eAA1C,YAA4DZ,KAErF,OAAO,gBAAC,WAAD,CAAgBwB,IAAMlB,EAAKmB,IAAMnB,EAAKoB,YAC3C,uBAAKC,UAAU,cAAclB,EAC1BR,GAAmB,uBAAK0B,UAAS,0DAAqDtB,IAAmBI,MAnG9G,EAAKE,MAAQ,CACXC,eAAgB,GAChBgB,iBAAmB,KACnBC,YAAa,GAEf,EAAKhB,gBAAkB,GAPN,E,qEAanB,gGACQT,EAAY0B,KAAKhC,MAAjBM,WACFwB,EAAmB1B,EAAEC,IAAIC,EAAU,wBAFzC,mBAISwB,EAJT,iDAOIE,KAAKC,UAAS,SAAApB,GAAK,cAAOA,GAAP,IAAciB,wBAAjC,iBAAqD,oGAC9BI,6BAAkCJ,GADJ,OAC/Cd,EAD+C,OAEnD,EAAKiB,UAAS,SAAApB,GAAK,cAAOA,GAAP,IAAcC,eAAeE,OAFG,4CAPzD,gD,gFAmBA,SAAsBmB,EAAWC,GAC/B,SAAKC,iBAGFL,KAAKhC,MAAMM,WAAa6B,EAAU7B,UAGhCF,EAAEkC,QAAQN,KAAKnB,MAAMC,eAAgBsB,EAAUtB,iBAG/CV,EAAEkC,QAAQN,KAAKnB,MAAMiB,iBAAkBM,EAAUN,mBAIjD1B,EAAEkC,QAAQN,KAAKhC,MAAMU,KAAMyB,EAAUzB,OAGvCsB,KAAKnB,MAAMkB,cAAgBK,EAAUL,e,qDAS1C,WAAyBQ,GAAzB,qFACQjC,EAAY0B,KAAKhC,MAAjBM,SACAwB,EAAoBE,KAAKnB,MAAzBiB,iBACAU,EAAsBpC,EAAEC,IAAIC,EAAU,sBAAuBwB,GAE9D1B,EAAEkC,QAAQC,EAAU7B,KAAMsB,KAAKhC,MAAMU,OACxCsB,KAAKC,UAAS,SAAApB,GAAK,cAAQA,GAAR,IAAe4B,MAAO,EAAKzC,MAAMU,UAEnD8B,IAAwBV,EAR7B,mBASSU,EATT,iDAYIR,KAAKC,UAAS,SAAApB,GAAK,cAAOA,GAAP,IAAciB,iBAAkBU,OAAnD,iBAAyE,oGAClDN,6BAAkCM,GADgB,OACnExB,EADmE,OAEvE,EAAKiB,UAAS,SAAApB,GAAK,cAAOA,GAAP,IAAcC,eAAeE,OAFuB,4CAZ7E,gD,wEAsDA,WACE,IAAWyB,EAAST,KAAKhC,MAApBU,KACCgC,EAAiB5C,QAAO6C,0BAAqBX,KAAKhC,MAAMM,SAAS,oBAAsB,GAC7F,OAAKoC,GAAoBtC,EAAEC,IAAIoC,EAAO,UAG/BG,KAAKC,KAAKJ,EAAMK,OAASJ,GAFvB,I,qBASX,SAAQK,IACNA,EAAOjD,OAAOiD,MAEZA,EAAO,GAENA,EAAO,IACRA,EAAO,GAENA,EAAOf,KAAKgB,iBACbD,EAAOf,KAAKgB,gBAEXhB,KAAKnB,MAAMkB,cAAgBgB,GAG9Bf,KAAKC,UAAS,SAAApB,GAAK,cAAQA,GAAR,IAAekB,YAAagB,S,8BAOjD,WAAkB,WACVzC,EAAW,EAAH,GAAO0B,KAAKhC,MAAMM,UAEhC,IADoB0B,KAAKhC,MAApBU,KACMoC,UAAYT,gBACrB,OAAO,KAET,IAAIY,GAAwBN,0BAAqBX,KAAKhC,MAAMM,SAAU,0BAA4B,GAClG,GAAG2C,EAAsB,CACvB,IAAOlB,EAAeC,KAAKnB,MAApBkB,YACDmB,EAAYlB,KAAKgB,eACvB,GAA6B,UAA1BC,EAAkC,CACnC3C,EAAS6C,wBAAyB,EAClC7C,EAAS8C,iBAAkB,EAC3B,IAAMC,EAAkB,CACtB/C,WACA4C,YACAI,UAAWtB,KAAKnB,MAAMkB,YAAc,EACpCwB,SAAU,WACR,EAAKC,QAAQ,EAAK3C,MAAMkB,YAAc,IAExC0B,aAAc,WACZ,EAAKD,QAAQ,EAAK3C,MAAMkB,YAAc,IAExC2B,SAAU,SAACX,GACT,EAAKS,QAAQT,EAAO,IAEtBY,SAAU3B,KAAKhC,MAAMsB,QAAQqB,qBAAqB,kBAClDiB,SAAU5B,KAAKhC,MAAMsB,QAAQuC,SAG/B,OAAO,gBAACC,EAAA,EAAeT,GAEzB,MAAiC,cAA1BJ,EAAwC,uBAAKpB,UAAU,0BAC5D,0BAAQA,UAAW,+BAAiCE,GAAe,EAAI,iBAAmB,IAClFgC,SAAUhC,GAAe,EACzBiC,QAAS,WAAK,EAAKR,QAAQzB,EAAc,KAC/C,4BAAOzB,EAAS2D,iBAAmB,KAClCC,qBAAgB5D,EAAS6D,YAG5B,0BAAQtC,UAAW,2BAA6BE,IAAgBmB,EAAY,iBAAmB,IACvFa,SAAUhC,IAAgBmB,EAC1Bc,QAAS,WAAK,EAAKR,QAAQzB,EAAc,KAC/C,4BAAOzB,EAAS8D,iBAAmB,KAClCF,qBAAgB5D,EAAS+D,aAG9B,uBAAKxC,UAAU,qBACVvB,EAASgE,sBAAwB,0BAAQzC,UAAW,6BACrDmC,QAAS,kBAAM,EAAKR,QAAQzB,EAAc,IAC1CgC,SAAUhC,GAAe,GAEzB,wBAAMwC,wBAAyB,CAAEC,OAAQlE,EAASmE,WAAa,oBAC5DP,qBAAgB5D,EAAS6D,aAE3B7D,EAASoE,2BAA6B,uBAAK7C,UAAU,2BACrDvB,EAASqE,WAEVrE,EAASsE,uBAAyB,0BAAQ/C,UAAU,yBAClDmC,QAAS,kBAAM,EAAKR,QAAQzB,EAAc,IAC1CgC,SAAUhC,IAAgBmB,GAE1B,wBAAMqB,wBAAyB,CAAEC,OAAQlE,EAASuE,WAAa,gBAC9DX,qBAAgB5D,EAAS+D,aAiBlC,OAAO,O,oBAGT,WAAS,WACAtC,EAAeC,KAAKnB,MAApBkB,YACDW,EAAiB5C,QAAO6C,0BAAqBX,KAAKhC,MAAMM,SAAS,oBAAsB,GAClFmC,EAAST,KAAKhC,MAApBU,MACCN,EAAE0E,QAAQrC,IAAWrC,EAAE2E,SAAStC,KACpCA,EAAQ,CAACA,IAENrC,EAAE0E,QAAQrC,KACbA,EAAQ,IAEV,IAAIuC,EAAa,EACdtC,GAAkB5C,OAAO4C,KACvBX,EAAc,IACfiD,GAAcjD,EAAc,GAAKW,GAEnCD,EAAQA,EAAMwC,MAAMD,EAAYA,EAAatC,IAE/C,IAAIhD,EAAeI,QAAO6C,0BAAqBX,KAAKhC,MAAMM,SAAS,mBAAqB,EACpFX,GAAoBgD,0BAAqBX,KAAKhC,MAAMM,SAAS,sBAAwB,GACrFV,GAAiB+C,0BAAqBX,KAAKhC,MAAMM,SAAS,mBAAqB,GAGnF,OAAO,gBAAC,WAAD,KACL,gBAAC,EAAD,CAAcZ,aAAcA,EACMC,kBAAmBA,EACnBC,eAAgBA,EAChBiC,UAAU,eACzCY,EAAMyC,KAAI,SAAC7F,EAAGa,GACb,OAAO,EAAKD,WAAW+E,EAAa9E,OAGvC8B,KAAKmD,wB,GArQa/D,aA0QzB,WAAgBpB,GACd,MAAwC,eAArCA,EAAMM,SAAS8E,oBACb/C,mBACDrC,EAAQ,EAAH,GAAOA,IACNM,SAAN,KAAqBN,EAAMM,UAC3BN,EAAMU,KAAO2E,MAAMC,KAAK,CAACxC,OAAQ,MAAM,iBAAO,OAC9CyC,mBAAcvF,EAAMU,OAEhB,gBAACX,EAAeC,IAEjB,gBAAC,IAAwBA,EAAO,gBAACD,EAAD,Q,ICxOzC,E,wcAnDE,WAAYC,GAAO,6BACjB,cAAMA,IACDa,MAAQ,CACXP,SAAUN,EAAMsB,QAAQkE,eAE1BxF,EAAMsB,QAAQV,WAAd,UACI6E,OAAOC,kBACTD,OAAOC,kBAAP,WAEE1F,EAAM2F,aACR,EAAKC,OAAS5F,EAAM2F,YAAN,YAVC,E,wCAmBnB,WAAsB,IAAZE,EAAY,uDAAJ,GAChB,MAA4D,eAAxD7D,KAAKhC,MAAMsB,QAAQkE,YAAY,yBAG9BK,EAAMC,YAAcD,EAAME,c,oBAMjC,WACE,IAAK/D,KAAKhC,MAAMgG,aAAaC,YAAY,qBACvC,MAAO,GAET,IAAIJ,EAAQ,IAAIK,IAAMlE,KAAKhC,MAAMsB,QAAQkE,cAAcW,aAAe,GAAInE,MAC1E,IAAKA,KAAKoE,UAAUP,GAClB,OAAO,2BAAKrE,SAAS,yBAEvB,IAAId,EAAOmF,EAAMQ,aAAarE,KAAKnB,MAAMyF,YAAc,GACvD,GAA4D,eAAxDtE,KAAKhC,MAAMsB,QAAQkE,YAAY,qBAAuC,CACxE,IAAIe,EAAOvE,KAAKhC,MAAMsB,QAAQkE,YAAY,mBAAoB,IAC9De,EAAOA,EAAKC,QAAQ,MAAO,IAAIA,QAAQ,MAAO,IAC9C9F,GAAO+F,mBAAcF,EAAM,GAAIvE,KAAKhC,MAAMsB,QAAQoF,kBAAkBC,WAEtE,OAAO,oBAAC,EAAD,CAAgBd,MAAOA,EACPG,aAAchE,KAAKhC,MAAMgG,aACzBtF,KAAMA,EACNY,QAASU,KAAKhC,MAAMsB,QACpBhB,SAAU0B,KAAKhC,MAAMsB,QAAQkE,oB,GAhD9BoB,Y,uKCsB1B,IAM+CC,EACzCC,EAAQC,EAuLVC,GAAc,G,4BAAAC,GAAY,EAAAC,GAC1BC,GAzL2CN,EAyLnBG,EAtLnBD,EAAQD,EAAsB,SAAUM,IAC7C,OAAUD,EAAOC,GAEjB,IAfkBC,EAAeC,EAe7BC,GAfcF,EAeQF,EAfOG,EAErC,WAAuC,GAAuB,oBAAZE,UAA4BA,QAAQC,UAAW,OAAO,EAAO,GAAID,QAAQC,UAAUC,KAAM,OAAO,EAAO,GAAqB,mBAAVC,MAAsB,OAAO,EAAM,IAAiF,OAA3EC,KAAKC,UAAUC,SAASC,KAAKP,QAAQC,UAAUG,KAAM,IAAI,iBAAyB,EAAQ,MAAOI,GAAK,OAAO,GAFzPC,GAAoC,WAAkC,IAAsCC,EAAlCC,GAAQ,OAAgBd,GAAkB,GAAIC,EAA2B,CAAE,IAAIc,GAAY,OAAgBpG,MAAMqG,YAAaH,EAASV,QAAQC,UAAUU,EAAOG,UAAWF,QAAqBF,EAASC,EAAMI,MAAMvG,KAAMsG,WAAc,OAAO,OAA2BtG,KAAMkG,KAiBxZ,SAASf,EAAMnH,GACb,IAAIwI,EA6EJ,OA3EA,OAAgBxG,KAAMmF,IAEtBqB,EAAQjB,EAAOQ,KAAK/F,OACdyG,YAAS,EACfD,EAAME,iBAAc,EACpBF,EAAMG,SAAU,EAChBH,EAAMI,aAAe,GAErBJ,EAAMK,kBAAoB,SAAUC,EAAUC,GAC5C,IAAIC,EAAcR,EAAMxI,MACpBiJ,EAAeD,EAAYC,aAC3BC,EAAgBF,EAAYE,cAE5BC,GAAa,OAAkBL,EAAUC,EAAYG,GAEzD,IAAKC,EAWH,cAVOX,EAAME,iBAEbF,EAAMvG,SAAS,CACbkH,WAAY,GACZC,iBAAkB,GAClBC,cAAe,GACfC,WAAW,EACXC,kBAAkB,IAMtB,GAAIN,GAAgBT,EAAMI,aAAaO,GACrCX,EAAMvG,SAAS,CACbkH,WAAYA,EACZC,iBAAkBD,EAClBE,cAAeb,EAAMI,aAAaO,GAClCG,WAAW,EACXC,kBAAkB,QAEf,CACL,IAAIC,EAAUhB,EAAME,YAAc,GAElCF,EAAMvG,SAAS,CACbkH,WAAYA,EACZG,WAAW,EACXC,kBAAmBf,EAAM3H,MAAMuI,mBAC9B,WACDZ,EAAMiB,YAAYN,GAAY,SAAUO,GACjClB,EAAMG,UAEPe,IACFlB,EAAMI,aAAaO,GAAcO,GAG/BF,IAAYhB,EAAME,qBACfF,EAAME,YAEbF,EAAMvG,SAAS,CACbqH,WAAW,EACXF,iBAAkBD,EAClBE,cAAeK,GAAW,GAC1BH,kBAAkB,YAM1B,OAAOJ,GAGTX,EAAM3H,MAAQ,CACZ8I,eAAgBtE,MAAMP,QAAQ9E,EAAM2J,gBAAkB3J,EAAM2J,oBAAiBC,EAC7ET,gBAAwC,IAArBnJ,EAAMmJ,WAA6BnJ,EAAMmJ,WAAa,GACzEG,WAAoC,IAAzBtJ,EAAM2J,eACjBN,cAAe,GACfE,kBAAkB,GAEbf,EA+FT,OA5FA,OAAarB,EAAO,CAAC,CACnBzF,IAAK,oBACLmI,MAAO,WACL,IAAIC,EAAS9H,KAEbA,KAAK2G,SAAU,EACf,IAAIgB,EAAiB3H,KAAKhC,MAAM2J,eAC5BR,EAAanH,KAAKnB,MAAMsI,YAEL,IAAnBQ,GACF3H,KAAKyH,YAAYN,GAAY,SAAUO,GACrC,GAAKI,EAAOnB,QAAZ,CACA,IAAIW,IAAcQ,EAAOpB,YAEzBoB,EAAO7H,SAAS,CACd0H,eAAgBD,GAAW,GAC3BJ,UAAWA,UAKlB,CACD5H,IAAK,mCACLmI,MAAO,SAA0C1H,GAE3CA,EAAU8G,eAAiBjH,KAAKhC,MAAMiJ,eACxCjH,KAAK4G,aAAe,IAGlBzG,EAAUwH,iBAAmB3H,KAAKhC,MAAM2J,gBAC1C3H,KAAKC,SAAS,CACZ0H,eAAgBtE,MAAMP,QAAQ3C,EAAUwH,gBAAkBxH,EAAUwH,oBAAiBC,MAI1F,CACDlI,IAAK,uBACLmI,MAAO,WACL7H,KAAK2G,SAAU,IAEhB,CACDjH,IAAK,QACLmI,MAAO,WACL7H,KAAKyG,OAAOsB,UAEb,CACDrI,IAAK,OACLmI,MAAO,WACL7H,KAAKyG,OAAOuB,SAEb,CACDtI,IAAK,cACLmI,MAAO,SAAqBV,EAAYc,GACtC,IAAIR,EAAczH,KAAKhC,MAAMyJ,YAC7B,IAAKA,EAAa,OAAOQ,IACzB,IAAIC,EAAST,EAAYN,EAAYc,GAEjCC,GAAiC,mBAAhBA,EAAOC,MAC1BD,EAAOC,KAAKF,GAAU,WACpB,OAAOA,SAIZ,CACDvI,IAAK,SACLmI,MAAO,WACL,IAAIO,EAASpI,KAETqI,EAAerI,KAAKhC,MAEpBsK,GADcD,EAAaZ,YACXY,EAAaf,WAC7BtJ,GAAQ,OAAyBqK,EAAc,CAAC,cAAe,cAE/DE,EAAcvI,KAAKnB,MACnB8I,EAAiBY,EAAYZ,eAC7BR,EAAaoB,EAAYpB,WACzBG,EAAYiB,EAAYjB,UACxBF,EAAmBmB,EAAYnB,iBAC/BC,EAAgBkB,EAAYlB,cAE5BK,EADmBa,EAAYhB,iBACF,GAAKJ,GAAcC,EAAmBC,EAAgBM,GAAkB,GACzG,OAAoB,gBAAoB9C,GAAiB,OAAS,GAAI7G,EAAO,CAC3EwK,IAAK,SAAaC,GAChBL,EAAO3B,OAASgC,GAElBf,QAASA,EACTJ,UAAWA,GAAagB,EACxBpB,cAAelH,KAAK6G,yBAKnB1B,EAlL4B,CAmLnC,EAAAP,WAAYE,EAAO4D,aA5LJ,CACjBzB,cAAc,EACdU,gBAAgB,EAChBgB,aAAc,KACdrB,WAAW,GAwLuCvC,GAKpD","file":"PostsWidget.5f347725523ef838a07e.bundle.js","sourcesContent":["export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import styled from \"styled-components\";\r\n\r\nconst PostsWrapper = styled.div`{\r\n  grid-template-columns: repeat(${({columnsCount})=>columnsCount}, 1fr);\r\n  display: grid;    \r\n  ${({posts_columns_gap, posts_rows_gap}) =>{\r\n    let styles = '';\r\n    if(posts_columns_gap && ! Number(posts_columns_gap)){\r\n      styles += `grid-column-gap:${posts_columns_gap};`;\r\n    } else if(Number(posts_columns_gap)){\r\n      styles += `grid-column-gap:${posts_columns_gap}px;`;\r\n    }\r\n    if(posts_rows_gap && ! Number(posts_rows_gap)){\r\n      styles += `grid-row-gap:${posts_rows_gap};`;\r\n    } else if(Number(posts_rows_gap)){\r\n      styles += `grid-row-gap:${posts_rows_gap}px;`;\r\n    }\r\n    return styles;\r\n  }}\r\n`;\r\n\r\nexport default PostsWrapper;","import React from \"react\";\r\nimport ('../../../sass/altrp-pagination.scss');\r\nimport ('./altrp-posts.scss');\r\nimport AltrpQueryComponent from \"../altrp-query-component/altrp-query-component\";\r\nimport templateLoader from \"../../classes/modules/TemplateLoader\"\r\nimport frontElementsFabric from \"../../../../../front-app/src/js/classes/FrontElementsFabric\"\r\nimport AltrpModel from \"../../classes/AltrpModel\";\r\nimport ElementWrapper from \"../../../../../front-app/src/js/components/ElementWrapper\";\r\nimport {getResponsiveSetting, isEditor, renderAssetIcon, setAltrpIndex} from \"../../../../../front-app/src/js/helpers\";\r\nimport PostsWrapper from \"./components/PostsWrapper\";\r\nimport Pagination from \"../altrp-table/components/Pagination\";\r\n\r\nclass AltrpPosts extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      simpleTemplate: '',\r\n      simpleTemplateId : null,\r\n      currentPage: 1,\r\n    }\r\n    this.postsComponents = {};\r\n  }\r\n\r\n  /**\r\n   * Компонент загрузился\r\n   */\r\n  async componentDidMount() {\r\n    const{settings} = this.props;\r\n    let simpleTemplateId = _.get(settings, 'posts_card_template');\r\n    if(simpleTemplateId){\r\n      if(! simpleTemplateId){\r\n        return;\r\n      }\r\n      this.setState(state=>({...state, simpleTemplateId}), async()=>{\r\n        let template = await templateLoader.loadParsedTemplate(simpleTemplateId);\r\n        this.setState(state=>({...state, simpleTemplate:template}))\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Когда нужно обновлять компонент\r\n   * @param {{}} nextProps\r\n   * @param {{}} nextState\r\n   */\r\n  shouldComponentUpdate(nextProps, nextState){\r\n    if(! isEditor()){\r\n      return true;\r\n    }\r\n    if(this.props.settings !== nextProps.settings){\r\n      return true;\r\n    }\r\n    if(! _.isEqual(this.state.simpleTemplate, nextState.simpleTemplate)){\r\n      return true;\r\n    }\r\n    if(! _.isEqual(this.state.simpleTemplateId, nextState.simpleTemplateId)){\r\n      return true;\r\n    }\r\n    // if(this.props.data !== nextProps.data){\r\n    if(! _.isEqual(this.props.data, nextProps.data)){\r\n      return true;\r\n    }\r\n    if(this.state.currentPage !== nextState.currentPage){\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n  /**\r\n   * Компонент обновился\r\n   * @param {{}} prevProps\r\n   */\r\n  async componentDidUpdate(prevProps) {\r\n    const{settings} = this.props;\r\n    const{simpleTemplateId} = this.state;\r\n    const newSimpleTemplateId = _.get(settings, 'posts_card_template', simpleTemplateId);\r\n    // if(prevProps.posts !== this.state.posts)\r\n    if(! _.isEqual(prevProps.data, this.props.data)){\r\n      this.setState(state =>({...state, posts: this.props.data}));\r\n    }\r\n    if(newSimpleTemplateId !== simpleTemplateId){\r\n      if(! newSimpleTemplateId){\r\n        return;\r\n      }\r\n      this.setState(state=>({...state, simpleTemplateId: newSimpleTemplateId}),async ()=>{\r\n        let template = await templateLoader.loadParsedTemplate(newSimpleTemplateId);\r\n        this.setState(state=>({...state, simpleTemplate:template}));\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Отрисовывает отдельную карточку\r\n   * @param {int} idx - индекс в массиве записей\r\n   */\r\n  renderPost = (idx) => {\r\n    const hoverTemplateId = _.get(this.props.settings, 'posts_card_hover_template', null);\r\n    const transitionType = _.get(this.props.settings, 'posts_transition_type', null);\r\n    let post = _.cloneDeep(this.props.data[idx] || this.props.data);\r\n    let PostContentComponent = post.component || '';\r\n    if(this.state.simpleTemplate && ! _.get(this.postsComponents, `${this.state.simpleTemplate}.${idx}`)){\r\n      let template = frontElementsFabric.cloneElement(this.state.simpleTemplate);\r\n      template.setCardModel(new AltrpModel(post), idx);\r\n      PostContentComponent = React.createElement(template.componentClass,\r\n        {\r\n          element: template,\r\n          ElementWrapper: ElementWrapper,\r\n          children: template.children\r\n        });\r\n      _.set(this.postsComponents, `${this.state.simpleTemplate}.${idx}`, PostContentComponent)\r\n    } else if(_.get(this.postsComponents, `${this.state.simpleTemplate}.${idx}`)){\r\n      PostContentComponent = _.get(this.postsComponents, `${this.state.simpleTemplate}.${idx}`)\r\n    }\r\n    return <React.Fragment key={(post.id || post.altrpIndex)}>\r\n      <div className=\"altrp-post\">{PostContentComponent}\r\n        {hoverTemplateId && <div className={`altrp-post altrp-post--hover altrp-post--hover--${transitionType}`}>{PostContentComponent}</div>}\r\n      </div>\r\n\r\n    </React.Fragment>\r\n  };\r\n\r\n  /**\r\n   * Получаем количество страниц\r\n   * @return {int}\r\n   */\r\n\r\n  getPageCount(){\r\n    let {data: posts} = this.props;\r\n    const posts_per_page = Number(getResponsiveSetting(this.props.settings,'posts_per_page')) || 12;\r\n    if(! posts_per_page || ! _.get(posts, 'length')){\r\n      return 1;\r\n    }\r\n    return Math.ceil(posts.length / posts_per_page);\r\n  }\r\n\r\n  /**\r\n   * поменяем страницу\r\n   * @param {number} page\r\n   */\r\n  setPage(page){\r\n    page = Number(page);\r\n    if(! page){\r\n      page = 1;\r\n    }\r\n    if(page < 0){\r\n      page = 0;\r\n    }\r\n    if(page > this.getPageCount()){\r\n      page = this.getPageCount();\r\n    }\r\n    if(this.state.currentPage === page){\r\n      return;\r\n    }\r\n    this.setState(state =>({...state, currentPage: page}))\r\n  }\r\n\r\n  /**\r\n   * Выводим пагинацию\r\n   * @return {*}\r\n   */\r\n  renderPagination(){\r\n    const settings = {...this.props.settings};\r\n    let {data: posts} = this.props;\r\n    if(! posts.length && ! isEditor()){\r\n      return null;\r\n    }\r\n    let posts_pagination_type = getResponsiveSetting(this.props.settings, 'posts_pagination_type') || '';\r\n    if(posts_pagination_type){\r\n      const {currentPage} = this.state;\r\n      const pageCount = this.getPageCount();\r\n      if(posts_pagination_type === 'pages'){\r\n        settings.hide_pagination_select = true;\r\n        settings.hide_page_input = true;\r\n        const paginationProps = {\r\n          settings,\r\n          pageCount,\r\n          pageIndex: this.state.currentPage - 1,\r\n          nextPage: ()=>{\r\n            this.setPage(this.state.currentPage + 1);\r\n          },\r\n          previousPage: ()=>{\r\n            this.setPage(this.state.currentPage - 1);\r\n          },\r\n          gotoPage: (page)=>{\r\n            this.setPage(page + 1);\r\n          },\r\n          pageSize: this.props.element.getResponsiveSetting('posts_per_page'),\r\n          widgetId: this.props.element.getId(),\r\n        };\r\n\r\n        return <Pagination {...paginationProps} />\r\n      }\r\n      return posts_pagination_type === \"prev_next\" ? <div className=\"altrp-pagination-pages\">\r\n        <button className={\"altrp-pagination__previous \" + (currentPage <= 1 ? 'state-disabled' : '')}\r\n                disabled={currentPage <= 1}\r\n                onClick={()=>{this.setPage(currentPage - 1)}}>\r\n          <span>{settings.posts_prev_text || ''}</span>\r\n          {renderAssetIcon(settings.prev_icon)}\r\n        </button>\r\n\r\n        <button className={\"altrp-pagination__next \" + (currentPage === pageCount ? 'state-disabled' : '')}\r\n                disabled={currentPage === pageCount}\r\n                onClick={()=>{this.setPage(currentPage + 1)}}>\r\n          <span>{settings.posts_next_text || ''}</span>\r\n          {renderAssetIcon(settings.next_icon)}\r\n        </button>\r\n      </div> :\r\n      <div className=\"altrp-pagination\">\r\n        {! settings.hide_pre_page_button && <button className={\"altrp-pagination__previous\"}\r\n          onClick={() => this.setPage(currentPage - 1)}\r\n          disabled={currentPage <= 1}\r\n        >\r\n          <span dangerouslySetInnerHTML={{ __html: settings.prev_text || 'Previous Page' }} />\r\n            {renderAssetIcon(settings.prev_icon)}\r\n        </button>}\r\n        {! settings.hide_pages_buttons_button && <div className=\"altrp-pagination__count\">\r\n          {settings.pageText}\r\n        </div>}\r\n        {!settings.hide_next_page_button && <button className=\"altrp-pagination__next\"\r\n            onClick={() => this.setPage(currentPage + 1)}\r\n            disabled={currentPage === pageCount}\r\n          >\r\n            <span dangerouslySetInnerHTML={{ __html: settings.next_text || 'Next Page' }} />\r\n            {renderAssetIcon(settings.next_icon)}\r\n          </button>}\r\n        {/* {!settings.hide_page_input && <input className=\"altrp-pagination__goto-page\"\r\n          type=\"number\"\r\n          defaultValue={pageIndex + 1}\r\n          onChange={e => this.setPage(+e.target.value)}\r\n        />}\r\n        {!settings.hide_pagination_select && countOptions && <AltrpSelect className=\"altrp-pagination__select-size\"\r\n          options={countOptions}\r\n          classNamePrefix={widgetId + ' altrp-field-select2'}\r\n          value={countOptions.find(o => o.value === pageSize)}\r\n          isSearchable={false}\r\n          onChange={value => {\r\n            setPageSize(value.value)\r\n          }} />} */}\r\n      </div>\r\n    }\r\n    return null;\r\n  }\r\n\r\n  render() {\r\n    const {currentPage} = this.state;\r\n    const posts_per_page = Number(getResponsiveSetting(this.props.settings,'posts_per_page')) || 12;\r\n    let {data: posts} = this.props;\r\n    if((! _.isArray(posts)) && _.isObject(posts)){\r\n      posts = [posts];\r\n    }\r\n    if(! _.isArray(posts)){\r\n      posts = [];\r\n    }\r\n    let postsStart = 0;\r\n    if(posts_per_page && Number(posts_per_page)){\r\n      if(currentPage > 1){\r\n        postsStart = (currentPage - 1) * posts_per_page\r\n      }\r\n      posts = posts.slice(postsStart, postsStart + posts_per_page);\r\n    }\r\n    let columnsCount = Number(getResponsiveSetting(this.props.settings,'posts_columns')) || 1;\r\n    let posts_columns_gap = getResponsiveSetting(this.props.settings,'posts_columns_gap') || '';\r\n    let posts_rows_gap = getResponsiveSetting(this.props.settings,'posts_rows_gap') || '';\r\n\r\n\r\n    return <React.Fragment>\r\n      <PostsWrapper columnsCount={columnsCount}\r\n                                        posts_columns_gap={posts_columns_gap}\r\n                                        posts_rows_gap={posts_rows_gap}\r\n                                        className=\"altrp-posts\">\r\n        {posts.map((p, idx)=>{\r\n          return this.renderPost(postsStart + idx);\r\n        })}\r\n      </PostsWrapper>\r\n      {this.renderPagination()}\r\n    </React.Fragment>\r\n  }\r\n}\r\n\r\nexport default (props) => {\r\n  if(props.settings.choose_datasource === 'datasource'){\r\n    if(isEditor()){\r\n      props = {...props};\r\n      props.settings = {...props.settings};\r\n      props.data = Array.from({length: 100}, () => ({}));\r\n      setAltrpIndex(props.data);\r\n    }\r\n    return<AltrpPosts {...props}/>\r\n  }\r\n  return <AltrpQueryComponent {...props}><AltrpPosts/></AltrpQueryComponent>\r\n}\r\n","import Query from \"../../classes/Query\";\r\nimport {getDataByPath} from \"../../../../../front-app/src/js/helpers\";\r\nimport PostsComponent from '../altrp-posts/altrp-posts';\r\n\r\nclass PostsWidget extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      settings: props.element.getSettings(),\r\n    };\r\n    props.element.component = this;\r\n    if (window.elementDecorator) {\r\n      window.elementDecorator(this);\r\n    }\r\n    if (props.baseRender) {\r\n      this.render = props.baseRender(this);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Показывать ли записи\r\n   * @param{Query} query\r\n   * @return {boolean}\r\n   */\r\n  showPosts(query = {}) {\r\n    if (this.props.element.getSettings('choose_datasource') === 'datasource') {\r\n      return true;\r\n    }\r\n    if (!query.modelName && !query.dataSource) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.currentModel.getProperty('altrpModelUpdated')) {\r\n      return '';\r\n    }\r\n    let query = new Query(this.props.element.getSettings().table_query || {}, this);\r\n    if (!this.showPosts(query)) {\r\n      return <div children=\"Please Choose Source\"/>\r\n    }\r\n    let data = query.getFromModel(this.state.modelData) || [];\r\n    if (this.props.element.getSettings('choose_datasource') === 'datasource') {\r\n      let path = this.props.element.getSettings('posts_datasource', '');\r\n      path = path.replace(/}}/g, '').replace(/{{/g, '');\r\n      data = getDataByPath(path, [], this.props.element.getCurrentModel().getData());\r\n    }\r\n    return <PostsComponent query={query}\r\n                           currentModel={this.props.currentModel}\r\n                           data={data}\r\n                           element={this.props.element}\r\n                           settings={this.props.element.getSettings()}/>;\r\n  }\r\n}\r\n\r\nexport default PostsWidget\r\n\r\n","import _objectWithoutProperties from '@babel/runtime/helpers/esm/objectWithoutProperties';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport '@babel/runtime/helpers/slicedToArray';\nimport '@babel/runtime/helpers/toConsumableArray';\nimport '@babel/runtime/helpers/defineProperty';\nimport _classCallCheck from '@babel/runtime/helpers/esm/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/esm/createClass';\nimport '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/esm/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/esm/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/esm/getPrototypeOf';\nimport React, { Component } from 'react';\nimport 'memoize-one';\nimport '@emotion/core';\nimport 'react-dom';\nimport '@babel/runtime/helpers/typeof';\nimport { G as handleInputChange } from '../../dist/index-75b02bac.browser.esm.js';\nimport { S as Select } from '../../dist/Select-e1cf49ae.browser.esm.js';\nimport '@emotion/css';\nimport '@babel/runtime/helpers/taggedTemplateLiteral';\nimport 'react-input-autosize';\nimport { m as manageState } from '../../dist/stateManager-2f2b6f5b.browser.esm.js';\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\nvar defaultProps = {\n  cacheOptions: false,\n  defaultOptions: false,\n  filterOption: null,\n  isLoading: false\n};\nvar makeAsyncSelect = function makeAsyncSelect(SelectComponent) {\n  var _class, _temp;\n\n  return _temp = _class = /*#__PURE__*/function (_Component) {\n    _inherits(Async, _Component);\n\n    var _super = _createSuper(Async);\n\n    function Async(props) {\n      var _this;\n\n      _classCallCheck(this, Async);\n\n      _this = _super.call(this);\n      _this.select = void 0;\n      _this.lastRequest = void 0;\n      _this.mounted = false;\n      _this.optionsCache = {};\n\n      _this.handleInputChange = function (newValue, actionMeta) {\n        var _this$props = _this.props,\n            cacheOptions = _this$props.cacheOptions,\n            onInputChange = _this$props.onInputChange; // TODO\n\n        var inputValue = handleInputChange(newValue, actionMeta, onInputChange);\n\n        if (!inputValue) {\n          delete _this.lastRequest;\n\n          _this.setState({\n            inputValue: '',\n            loadedInputValue: '',\n            loadedOptions: [],\n            isLoading: false,\n            passEmptyOptions: false\n          });\n\n          return;\n        }\n\n        if (cacheOptions && _this.optionsCache[inputValue]) {\n          _this.setState({\n            inputValue: inputValue,\n            loadedInputValue: inputValue,\n            loadedOptions: _this.optionsCache[inputValue],\n            isLoading: false,\n            passEmptyOptions: false\n          });\n        } else {\n          var request = _this.lastRequest = {};\n\n          _this.setState({\n            inputValue: inputValue,\n            isLoading: true,\n            passEmptyOptions: !_this.state.loadedInputValue\n          }, function () {\n            _this.loadOptions(inputValue, function (options) {\n              if (!_this.mounted) return;\n\n              if (options) {\n                _this.optionsCache[inputValue] = options;\n              }\n\n              if (request !== _this.lastRequest) return;\n              delete _this.lastRequest;\n\n              _this.setState({\n                isLoading: false,\n                loadedInputValue: inputValue,\n                loadedOptions: options || [],\n                passEmptyOptions: false\n              });\n            });\n          });\n        }\n\n        return inputValue;\n      };\n\n      _this.state = {\n        defaultOptions: Array.isArray(props.defaultOptions) ? props.defaultOptions : undefined,\n        inputValue: typeof props.inputValue !== 'undefined' ? props.inputValue : '',\n        isLoading: props.defaultOptions === true,\n        loadedOptions: [],\n        passEmptyOptions: false\n      };\n      return _this;\n    }\n\n    _createClass(Async, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        var _this2 = this;\n\n        this.mounted = true;\n        var defaultOptions = this.props.defaultOptions;\n        var inputValue = this.state.inputValue;\n\n        if (defaultOptions === true) {\n          this.loadOptions(inputValue, function (options) {\n            if (!_this2.mounted) return;\n            var isLoading = !!_this2.lastRequest;\n\n            _this2.setState({\n              defaultOptions: options || [],\n              isLoading: isLoading\n            });\n          });\n        }\n      }\n    }, {\n      key: \"UNSAFE_componentWillReceiveProps\",\n      value: function UNSAFE_componentWillReceiveProps(nextProps) {\n        // if the cacheOptions prop changes, clear the cache\n        if (nextProps.cacheOptions !== this.props.cacheOptions) {\n          this.optionsCache = {};\n        }\n\n        if (nextProps.defaultOptions !== this.props.defaultOptions) {\n          this.setState({\n            defaultOptions: Array.isArray(nextProps.defaultOptions) ? nextProps.defaultOptions : undefined\n          });\n        }\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function componentWillUnmount() {\n        this.mounted = false;\n      }\n    }, {\n      key: \"focus\",\n      value: function focus() {\n        this.select.focus();\n      }\n    }, {\n      key: \"blur\",\n      value: function blur() {\n        this.select.blur();\n      }\n    }, {\n      key: \"loadOptions\",\n      value: function loadOptions(inputValue, callback) {\n        var loadOptions = this.props.loadOptions;\n        if (!loadOptions) return callback();\n        var loader = loadOptions(inputValue, callback);\n\n        if (loader && typeof loader.then === 'function') {\n          loader.then(callback, function () {\n            return callback();\n          });\n        }\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var _this3 = this;\n\n        var _this$props2 = this.props,\n            loadOptions = _this$props2.loadOptions,\n            isLoadingProp = _this$props2.isLoading,\n            props = _objectWithoutProperties(_this$props2, [\"loadOptions\", \"isLoading\"]);\n\n        var _this$state = this.state,\n            defaultOptions = _this$state.defaultOptions,\n            inputValue = _this$state.inputValue,\n            isLoading = _this$state.isLoading,\n            loadedInputValue = _this$state.loadedInputValue,\n            loadedOptions = _this$state.loadedOptions,\n            passEmptyOptions = _this$state.passEmptyOptions;\n        var options = passEmptyOptions ? [] : inputValue && loadedInputValue ? loadedOptions : defaultOptions || [];\n        return /*#__PURE__*/React.createElement(SelectComponent, _extends({}, props, {\n          ref: function ref(_ref) {\n            _this3.select = _ref;\n          },\n          options: options,\n          isLoading: isLoading || isLoadingProp,\n          onInputChange: this.handleInputChange\n        }));\n      }\n    }]);\n\n    return Async;\n  }(Component), _class.defaultProps = defaultProps, _temp;\n};\nvar SelectState = manageState(Select);\nvar Async = makeAsyncSelect(SelectState);\n\nexport default Async;\nexport { defaultProps, makeAsyncSelect };\n"],"sourceRoot":""}