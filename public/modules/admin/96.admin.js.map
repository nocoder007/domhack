{"version":3,"sources":["webpack:///./resources/modules/admin/src/js/store/ace-editor/actions.js","webpack:///./resources/modules/admin/src/js/store/admin-logo/actions.js","webpack:///./resources/modules/admin/src/js/store/admin-state/actions.js","webpack:///./resources/modules/admin/src/js/store/custom-fonts/actions.js","webpack:///./resources/modules/admin/src/js/store/modal-settings/actions.js","webpack:///./resources/modules/admin/src/js/store/modal-settings/reducers.js","webpack:///./resources/modules/admin/src/js/store/admin-state/reducers.js","webpack:///./resources/modules/admin/src/js/store/admin-logo/reducers.js","webpack:///./resources/modules/editor/src/js/store/assets-browser/reducers.js","webpack:///./resources/modules/admin/src/js/store/ace-editor/reducers.js","webpack:///./resources/modules/admin/src/js/store/websockets-storage/reducers.js","webpack:///./resources/modules/admin/src/js/store/custom-fonts/reducers.js","webpack:///./resources/modules/admin/src/js/store/reducers.js","webpack:///./resources/modules/admin/src/js/store/store.js","webpack:///./resources/modules/admin/src/js/store/websockets-storage/actions.js","webpack:///./resources/modules/editor/src/js/classes/AltrpModel.js","webpack:///./resources/modules/editor/src/js/classes/Resource.js","webpack:///./resources/modules/editor/src/js/consts.js","webpack:///./resources/modules/editor/src/js/store/assets-browser/actions.js","webpack:///./resources/modules/front-app/src/js/classes/Template.js","webpack:///./resources/modules/front-app/src/js/classes/Area.js","webpack:///./resources/modules/front-app/src/js/classes/Datasource.js","webpack:///./resources/modules/front-app/src/js/classes/Route.js","webpack:///./resources/modules/editor/src/js/components/altrp-svg/AltrpSVG.js","webpack:///./resources/modules/front-app/src/js/classes/converters/DataConverter.js","webpack:///./resources/modules/front-app/src/js/helpers.js","webpack:///./resources/modules/front-app/src/js/store/areas/actions.js","webpack:///./resources/modules/front-app/src/js/store/current-user/actions.js","webpack:///./resources/modules/editor/src/js/classes/AltrpUser.js","webpack:///./resources/modules/front-app/src/js/store/current-user/reducers.js"],"names":["SET_ACE","setAceEditor","AceEditor","type","SET_LOGO","setAdminLogo","logoData","SET_DISABLED","SET_ENABLE","SET_PROPERTY","setAdminDisable","setAdminEnable","setAdminProperty","propertyName","value","GET_CUSTOM_FONTS","getCustomFonts","metaValue","SET_MODAL_SETTINGS","TOGGLE_MODAL","setModalSettings","settings","toggleModal","defaultState","fields","active","title","submitButton","submit","data","console","log","success","res","adminEnable","window","admin_logo","onChoose","media","initialState","combineReducers","modalSettings","state","action","adminState","_","set","adminLogo","assetsManagerSettings","ASSETS_SHOW","ASSETS_TOGGLE","aceEditorReducer","currentUser","currentUserReducer","websocketStore","item","WEBSOCKETS_SERVER_ENABLED","enabled","WEBSOCKETS_SERVER_KEY","key","WEBSOCKETS_SERVER_PORT","port","customFonts","createStore","rootReducer","setWebsocketsEnabled","setWebsocketsKey","setWebsocketsPort","AltrpModel","this","cloneDeep","clone","isEmpty","name","defaultValue","get","has","getData","unset","queryString","MAX_FILE_SIZE","Resource","route","dynamicURL","replaceContentWithData","fetch","method","headers","then","ok","Promise","reject","text","status","json","id","error","url","getRoute","length","replace","searchString","indexOf","assign","_token","formData","FormData","hasFile","each","isArray","i","File","size","append","options","body","JSON","stringify","files","file","customHeaders","params","_params","forEach","paramValue","paramName","join","query","TEMPLATE_UPDATED","TEMPLATE_NEED_UPDATE","TEMPLATE_SAVING","DEFAULT_BREAKPOINT","DEFAULT_AREAS","SCREENS","icon","width","fullMediaQuery","mediaQuery","assetsShow","assetsToggle","templates","CSSclasses","push","sidebar_type","sidebar_location","styles","isString","custom_css","settingName","getSetting","component","setState","currentRouteComponent","updateToken","Math","random","appStore","dispatch","setAreas","getState","areas","_default","areaData","area","Area","template","Template","parse","area_name","_t","guid","template_settings","triggers","getProperty","excludePath","parsedTemplate","currentModel","currentDataStorage","isJSON","mbParseJSON","map","param","split","filter","line","trim","left","right","match","getDataByPath","path","model","models","parent_page_id","data_sources","data_source","Datasource","allowed","redirect","lazy","Route","_area","props","assetsCache","regex","RegExp","_props","svg","rawSVG","propsString","exec","content","resource","altrpHelpers","getAsText","prevProps","prevState","componentDidMount","divElement","SSR","childNodes","removeAttribute","outerHTML","document","createElement","innerHTML","children","dangerouslySetInnerHTML","__html","Component","isSSR","e","iconsManager","renderAsset","asset","dataUrl","React","src","refImg","createRef","fr","FileReader","readAsDataURL","onload","current","result","alt","ref","assetType","renderIcon","style","backgroundImage","undefined","parseParamsFromString","string","context","allowObject","replaceRight","urlParams","currentRouterMatch","lines","isObject","trueValue","falseValue","altrpCheck","_path","_right","altrpresponses","formsStore","altrpPageState","altrpPage","altrpMeta","queryData","location","href","getTimeValue","pathElements","elementId","updateType","propName","getComponentByElementId","element","getSettings","getDataFromLocalStorage","areaName","page_areas","find","extractPathFromString","CONDITIONS_OPTIONS","label","now","startOfMonth","Date","startOfYear","getPrevWeekStart","getNextWeekStart","getWeekStart","moment","format","date","monthShift","getFullYear","getMonth","yearShift","elements","el","elementWrapperRef","toString","today","daystoMonday","isoWeekday","add","subtract","daystoLastMonday","modelContext","paths","escapeRegExp","localStorage","getItem","Number","setAltrpIndex","array","idx","setProperty","altrpIndex","altrpRandomId","substr","JSONString","altrphelpers","sumFields","fieldName","sum","c","SET_AREAS","CHANGE_CURRENT_USER","SET_NOTICE_FOR_USER","SET_USERS_ONLINE","CHANGE_CURRENT_USER_PROPERTY","changeCurrentUser","user","permissions","ownPermissions","ownPermission","permission","parseInt","roles","ownRoles","ownRole","role","isAuth","hasPermissions","hasRoles","defaultModel","current_user","local_storage","Array","form","put","catch","newNotice","notice","members","AltrpUser","rootElement","getElementById","classList","remove"],"mappings":"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","file":"96.admin.js","sourcesContent":["export const SET_ACE = 'SET_ACE';\r\n\r\nexport function setAceEditor(AceEditor){\r\n  return {\r\n    AceEditor,\r\n    type: SET_ACE,\r\n  }\r\n}\r\n\r\n","export const SET_LOGO = 'SET_LOGO';\r\n\r\nexport function setAdminLogo(logoData){\r\n  return {\r\n    logoData,\r\n    type: SET_LOGO,\r\n  }\r\n}\r\n\r\n","export const SET_DISABLED = 'SET_DISABLED';\r\nexport const SET_ENABLE = 'SET_ENABLE';\r\nexport const SET_PROPERTY = 'SET_PROPERTY';\r\n\r\nexport function setAdminDisable(){\r\n  return {\r\n    type: SET_DISABLED,\r\n  }\r\n}\r\n\r\nexport function setAdminEnable(){\r\n  return {\r\n    type: SET_ENABLE,\r\n  }\r\n}\r\n\r\n/**\r\n * Устанавлевает свойство админки\r\n * @param propertyName\r\n * @param value\r\n * @return {{type: string, propertyName: *, value: *}}\r\n */\r\nexport function setAdminProperty(propertyName, value){\r\n\r\n  return {\r\n    type: SET_PROPERTY,\r\n    propertyName,\r\n    value,\r\n  }\r\n}","export const GET_CUSTOM_FONTS = 'GET_CUSTOM_FONTS';\r\n\r\nexport function getCustomFonts(metaValue){\r\n  return {\r\n    type: GET_CUSTOM_FONTS,\r\n    metaValue,\r\n  }\r\n}\r\n","export const SET_MODAL_SETTINGS = 'SET_MODAL_SETTINGS';\r\nexport const TOGGLE_MODAL = 'TOGGLE_MODAL';\r\n\r\nexport function setModalSettings(settings){\r\n  return {\r\n    ...settings,\r\n    type: SET_MODAL_SETTINGS,\r\n  }\r\n}\r\n\r\nexport function toggleModal(){\r\n  return {\r\n    type: TOGGLE_MODAL,\r\n  }\r\n}\r\n","import {SET_MODAL_SETTINGS, TOGGLE_MODAL} from \"./actions\";\r\n\r\nconst defaultState = {\r\n  fields: [],\r\n  active: false,\r\n  title: 'Modal',\r\n  submitButton: 'Submit',\r\n  submit: function(data){\r\n    console.log(data);\r\n  },\r\n  success: (res)=>{\r\n    console.log(res);\r\n  }\r\n};\r\n\r\nexport function modalSettingsReducer(state, action) {\r\n  state = state || defaultState;\r\n  switch (action.type){\r\n    case SET_MODAL_SETTINGS:{\r\n      state = {\r\n        fields: action.fields,\r\n        title: action.title || defaultState.title,\r\n        submit: action.submit || defaultState.submit,\r\n        submitButton: action.submitButton || defaultState.submitButton,\r\n        success: action.success || defaultState.success,\r\n        active: action.active,\r\n      };\r\n    }break;\r\n    case TOGGLE_MODAL:{\r\n      state = {\r\n        ...defaultState,\r\n        active: ! state.active,\r\n      };\r\n    }break;\r\n  }\r\n  return state;\r\n}","import {SET_DISABLED, SET_ENABLE, SET_PROPERTY} from \"./actions\";\r\n\r\nconst defaultState = {\r\n  adminEnable: true\r\n};\r\n\r\nexport function changeEnableState(state, action) {\r\n  state = state || defaultState;\r\n  switch (action.type){\r\n    case SET_DISABLED:{\r\n      state = {\r\n          ...state,\r\n        adminEnable: false\r\n      };\r\n    }break;\r\n    case SET_ENABLE:{\r\n      state = {\r\n        ...state,\r\n        adminEnable: true\r\n      };\r\n    }break;\r\n    case SET_PROPERTY:{\r\n      const {propertyName, value} = action;\r\n      if(propertyName){\r\n\r\n        state = {\r\n          ...state,\r\n        };\r\n        _.set(state, propertyName, value);\r\n      }\r\n    }break;\r\n  }\r\n  return state;\r\n}","import {SET_LOGO} from \"./actions\";\r\n\r\nconst defaultState = window.admin_logo ? window.admin_logo : {};\r\n\r\nexport function adminLogoReducer(state, action) {\r\n  state = state || defaultState;\r\n  switch (action.type){\r\n    case SET_LOGO:{\r\n      state = {\r\n          ...action.logoData\r\n      };\r\n    }break;\r\n  }\r\n  return state;\r\n}","import { ASSETS_SHOW, ASSETS_TOGGLE } from \"./actions\";\r\n\r\nconst defaultState = {\r\n  onChoose: function (media) {\r\n    // console.log(media);\r\n  },\r\n  active: false,\r\n};\r\n\r\nexport function assetsSettingsReducer(state, action) {\r\n  state = state || defaultState;\r\n  switch (action.type) {\r\n    case ASSETS_SHOW: {\r\n      state = {\r\n        ...action.settings,\r\n      };\r\n    } break;\r\n    case ASSETS_TOGGLE: {\r\n      state = { ...state };\r\n      state.active = false;\r\n    } break;\r\n  }\r\n  return state;\r\n}","import {SET_ACE} from \"./actions\";\r\n\r\nconst defaultState = {\r\n  AceEditor: null\r\n};\r\n\r\nexport function aceEditorReducer(state, action) {\r\n  state = state || defaultState;\r\n  switch (action.type){\r\n    case SET_ACE:{\r\n      state = {\r\n        AceEditor: action.AceEditor\r\n      };\r\n    }break;\r\n  }\r\n  return state;\r\n}","import {\r\n  WEBSOCKETS_SERVER_ENABLED,\r\n  WEBSOCKETS_SERVER_KEY,\r\n  WEBSOCKETS_SERVER_PORT\r\n} from './actions'\r\n\r\nconst initialState = {};\r\n\r\nexport const websocketsReducer = (state = initialState, { type, item }) => {\r\n  switch (type) {\r\n    case WEBSOCKETS_SERVER_ENABLED:{\r\n\r\n      state = { ...state,\r\n        enabled: item,\r\n      };\r\n\r\n    }break;\r\n    case WEBSOCKETS_SERVER_KEY:{\r\n\r\n      state = { ...state,\r\n        key: item\r\n      };\r\n\r\n    }break;\r\n    case WEBSOCKETS_SERVER_PORT:{\r\n\r\n      state = { ...state,\r\n        port: item,\r\n      };\r\n\r\n    }break;\r\n  }\r\n  return state;\r\n}","import {GET_CUSTOM_FONTS} from \"./actions\";\r\n\r\nconst defaultState = {\r\n    metaValue: []\r\n};\r\n\r\nexport function customFontsReduser(state, action) {\r\n  state = state || defaultState;\r\n  switch (action.type){\r\n    case GET_CUSTOM_FONTS:{\r\n      state = {\r\n          ...state,\r\n        metaValue: action.metaValue\r\n      };\r\n    }break;\r\n  }\r\n  return state;\r\n}","import {combineReducers} from 'redux';\r\nimport {modalSettingsReducer} from \"./modal-settings/reducers\";\r\nimport {changeEnableState} from \"./admin-state/reducers\";\r\nimport {adminLogoReducer} from \"./admin-logo/reducers\";\r\nimport {assetsSettingsReducer} from \"../../../../editor/src/js/store/assets-browser/reducers\";\r\nimport {aceEditorReducer} from \"./ace-editor/reducers\";\r\nimport {currentUserReducer} from \"../../../../front-app/src/js/store/current-user/reducers\";\r\nimport { websocketsReducer } from \"./websockets-storage/reducers\";\r\nimport {customFontsReduser} from \"./custom-fonts/reducers\";\r\n\r\n\r\nexport default combineReducers({\r\n  modalSettings: modalSettingsReducer,\r\n  adminState: changeEnableState,\r\n  adminLogo: adminLogoReducer,\r\n  assetsManagerSettings: assetsSettingsReducer,\r\n  aceEditorReducer: aceEditorReducer,\r\n  currentUser: currentUserReducer,\r\n  websocketStore: websocketsReducer,\r\n  customFonts: customFontsReduser,\r\n});\r\n","import {createStore} from 'redux';\r\nimport rootReducer from './reducers'\r\n\r\nconst store = createStore(rootReducer);\r\nexport default store;","export const WEBSOCKETS_SERVER_ENABLED = 'WEBSOCKETS_SERVER_ENABLED';\r\nexport const WEBSOCKETS_SERVER_KEY = 'WEBSOCKETS_SERVER_KEY';\r\nexport const WEBSOCKETS_SERVER_PORT = 'WEBSOCKETS_SERVER_PORT';\r\n\r\nexport function setWebsocketsEnabled(item){\r\n  return { type: WEBSOCKETS_SERVER_ENABLED, item }\r\n}\r\nexport function setWebsocketsKey(item){\r\n  return { type: WEBSOCKETS_SERVER_KEY, item }\r\n}\r\nexport function setWebsocketsPort(item){\r\n  return { type: WEBSOCKETS_SERVER_PORT, item }\r\n}\r\n","/**\r\n * Имеет интерфейс для доступы к свойствам data (любой вложенности)\r\n * @class AltrpModel\r\n */\r\nimport cloneDeep from 'lodash.clonedeep';\r\nimport get from 'lodash.get';\r\nimport set from 'lodash.set';\r\nimport has from 'lodash.has';\r\nimport unset from 'lodash.unset';\r\nimport isEmpty from 'lodash.isempty';\r\n// import {cloneDeep, get, set, has, unset, isString, isEmpty} from \"lodash\";\r\n\r\nclass AltrpModel {\r\n  constructor(data = {}) {\r\n    this.data = cloneDeep(data);\r\n  }\r\n\r\n  /**\r\n   * Возваращает объект данных\r\n   * @params {boolean} clone - клонировать или ссылку на данные\r\n   * @return {{}}\r\n   */\r\n  getData(clone = true) {\r\n    if(clone){\r\n      return cloneDeep(this.data);\r\n    }\r\n    return this.data;\r\n  }\r\n\r\n  /**\r\n   * Пустой ли объект\r\n   */\r\n  isEmpty(){\r\n    return isEmpty(this.data);\r\n  }\r\n  /**\r\n   * Возврашает значение свойства name\r\n   * @params {string} name\r\n   * @params {*} defaultValue\r\n   * @return {*}\r\n   */\r\n  getProperty(name, defaultValue = '') {\r\n    return get(this.data, name, defaultValue);\r\n  }\r\n  /**\r\n   * Возврашает значение свойства name\r\n   * @params {string} name\r\n   * @params {*} defaultValue\r\n   * @return {*}\r\n   */\r\n  hasProperty(name, defaultValue = '') {\r\n    return has(this.data, name);\r\n  }\r\n  /**\r\n   * Возврашает значение свойства name\r\n   * @params {string} name\r\n   * @params {*} defaultValue\r\n   * @return {{}}\r\n   */\r\n  setProperty(name, value = '') {\r\n    if(value instanceof AltrpModel){\r\n      value = value.getData(false);\r\n    }\r\n    return set(this.data, name, value);\r\n  }\r\n  /**\r\n   * Удаляет свойства name\r\n   * @params {string} name\r\n   * @return {*}\r\n   */\r\n  unsetProperty(name) {\r\n    return unset(this.data, name);\r\n  }\r\n}\r\nwindow.AltrpModel = AltrpModel;\r\nexport default AltrpModel\r\n","import queryString from \"query-string\";\nimport { replaceContentWithData } from \"../../../../front-app/src/js/helpers\";\nwindow.queryString = queryString;\n/**\n * @class Resource\n * */\nexport const MAX_FILE_SIZE = 83886080;\n\nclass Resource {\n  /**\n   * @member {Object} routes\n   * @member {string} routes.get\n   * @member {string} routes.post\n   * @member {string} routes.create\n   * @member {string} routes.getAll\n   */\n  constructor(data) {\n    this.route = data.route;\n    /**\n     * Нужно ли при каждом запросе подставлять в URL данные\n     * @type {*|boolean}\n     */\n    this.dynamicURL = data.dynamicURL || false;\n    if (!this.route) {\n      throw \"Нужен route\";\n    }\n  }\n\n  /**\n   * Получить роут\n   * @return {string}\n   */\n  getRoute() {\n    return this.dynamicURL ? replaceContentWithData(this.route) : this.route;\n  }\n  /**\n   * @return {Promise}\n   * */\n\n  getAuthorList() {\n    let options = {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    return fetch(\"/admin/ajax/users\", options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n\n  get(id) {\n    if (!id) {\n      console.error('Get only by \"id\"');\n    }\n\n    let options = {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    let route = this.getRoute();\n    let url;\n    if (route[route.length - 1] === \"/\") {\n      url = route + id;\n    } else {\n      url = route + \"/\" + id;\n    }\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n\n  /**\n   * Делает GET запрос в роуты по типу /route/{id}/somedata\n   * @return {Promise}\n   * */\n  getInContext(id) {\n    if (!id) {\n      console.error('Get only by \"id\"');\n    }\n\n    let options = {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    let route = this.getRoute();\n\n    let url = route.replace(`{id}`, id);\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n  /**\n   * простой запрос\n   * @return {Promise}\n   * */\n  getAll() {\n    let options = {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n\n    let url = this.getRoute();\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n  /**\n   * простой запрос\n   * @return {Promise}\n   * */\n  getAsText() {\n    let options = {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"text/plain\"\n      }\n    };\n\n    let url = this.getRoute();\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.text();\n    });\n  }\n\n  /**\n   * Запрос со строкой для поиска вхождений\n   * @param {string} searchString\n   * @return {Promise}\n   * */\n  search(searchString) {\n    let options = {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    let url;\n    if (this.getRoute().indexOf(\"?\") === -1) {\n      url = this.getRoute() + `?s=${searchString}`;\n    } else {\n      url = this.getRoute() + `&s=${searchString}`;\n    }\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n  /**\n   * @param {any} data\n   * @param {object | null} headers\n   * @return {Promise}\n   * */\n  post(data = {}, headers) {\n    headers = _.assign(\n      {\n        \"X-CSRF-TOKEN\": _token\n        // 'Content-Type': 'application/json',\n        // 'Accept': 'application/json',\n      },\n      headers\n    );\n    let formData = new FormData();\n    let hasFile = false;\n    _.each(data, (value, key) => {\n      if (_.isArray(value)) {\n        for (let i = 0; i < value.length; i++) {\n          if (value[i] instanceof File) {\n            hasFile = true;\n          }\n          if (value[i].size > MAX_FILE_SIZE) {\n            continue;\n          }\n          formData.append(`${key}[${i}]`, value[i]);\n        }\n      } else {\n        formData.append(key, value);\n      }\n    });\n    if (!hasFile) {\n      headers[\"Content-Type\"] = \"application/json\";\n      headers[\"Accept\"] = \"application/json\";\n    }\n    let options = {\n      method: \"POST\",\n      body: hasFile ? formData : JSON.stringify(data),\n      headers\n    };\n    return fetch(this.getRoute(), options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n    // .catch(err => {\n    //   console.error(err);\n    //   return Promise.reject(err.then(), err.status);\n    //   return err.then();\n    // });\n  }\n  /**\n   * @param {FileList | File[]} files\n   * @return {Promise}\n   * */\n  postFiles(files) {\n    // fileTypes = fileTypes || \"image\";\n    let headers = {\n      \"X-CSRF-TOKEN\": _token\n    };\n    let formData = new FormData();\n    // fileTypes = fileTypes.split(\",\");\n    // fileTypes.forEach(fileType => {\n    //   if (!fileType) {\n    //     return;\n    //   }\n    //   fileType = fileType.trim();\n    //\n    // });\n    for (let i = 0; i < files.length; i++) {\n      if (\n        files[i].size > MAX_FILE_SIZE\n        // ||          files[i].type.indexOf(fileType) === -1\n      ) {\n        continue;\n      }\n      formData.append(`files[${i}]`, files[i]);\n    }\n    let options = {\n      method: \"POST\",\n      body: formData,\n      headers\n    };\n    return fetch(this.getRoute(), options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n\n  /**\n   * @param {File} file\n   * @return {Promise}\n   * */\n  postFile(file) {\n    let headers = {\n      \"X-CSRF-TOKEN\": _token\n    };\n    let formData = new FormData();\n    formData.append(\"favicon\", file);\n    let options = {\n      method: \"POST\",\n      body: formData,\n      headers\n    };\n    return fetch(this.getRoute(), options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n\n  /**\n   * @return {Promise}\n   * */\n  put(id, data, headers = null) {\n    headers = _.assign(\n      {\n        \"X-CSRF-TOKEN\": _token\n        // 'Content-Type': 'application/json',\n        // 'Accept': 'application/json',\n      },\n      headers\n    );\n    let formData = new FormData();\n    let hasFile = false;\n\n    _.each(data, (value, key) => {\n      if (_.isArray(value)) {\n        for (let i = 0; i < value.length; i++) {\n          if (value[i] instanceof File) {\n            hasFile = true;\n          }\n          if (value[i].size > MAX_FILE_SIZE) {\n            console.log(value[i]);\n            continue;\n          }\n          formData.append(`${key}[${i}]`, value[i]);\n        }\n      } else {\n        formData.append(key, value);\n      }\n    });\n\n    if (!hasFile) {\n      headers[\"Content-Type\"] = \"application/json\";\n      headers[\"Accept\"] = \"application/json\";\n    }\n    let options = {\n      method: \"put\",\n      // body: JSON.stringify(data),\n      body: hasFile ? formData : JSON.stringify(data),\n      headers: headers\n    };\n    let url = this.getRoute() + (id ? \"/\" + id : \"\");\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject(res.text(), res.status);\n      }\n      return res.json();\n    });\n  }\n  /**\n   * @param {string} id\n   * @param {{}} data\n   * @param {string | {}} customHeaders\n   * @return {Promise}\n   * */\n  delete(id = \"\", data = {}, customHeaders) {\n    let options = {\n      method: \"delete\",\n      headers: _.assign(\n        {\n          \"X-CSRF-TOKEN\": _token,\n          \"Content-Type\": \"application/json\",\n          \"Accept\": \"application/json\",\n        },\n        customHeaders\n      )\n    };\n    if (!_.isEmpty(data)) {\n      options.body = JSON.stringify(data);\n    }\n    let url = this.getRoute() + (id ? \"/\" + id : \"\");\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n  /**\n   * @return {Promise}\n   * */\n  getOptions() {\n    let options = {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    let url = this.getRoute() + \"/options\";\n    return fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n  }\n\n  /**\n   * GET запрос с параметрами\n   * @param {object} params\n   * @param {string | {}} customHeaders\n   * @return {Promise}\n   * */\n  async getQueried(params, customHeaders = null) {\n    let options = {\n      method: \"get\",\n      headers: _.assign(\n        {\n          \"Content-Type\": \"application/json\"\n        },\n        customHeaders\n      )\n    };\n    let _params = {};\n    _.forEach(params, (paramValue, paramName) => {\n      if (_.isArray(paramValue)) {\n        paramValue = paramValue.join(\",\");\n      }\n      _params[paramName] = paramValue;\n    });\n    let url = queryString.parseUrl(this.getRoute()).url;\n    _params = _.assign(queryString.parseUrl(this.route).query, _params);\n    url = `${url}?${queryString.stringify(_params)}`;\n    let res = await fetch(url, options).then(res => {\n      if (res.ok === false) {\n        return Promise.reject({ res: res.text(), status: res.status });\n      }\n      return res.json();\n    });\n    // console.log(res)\n    return res;\n  }\n}\n\nexport default Resource;\n","const CONSTANTS = {\r\n  TEMPLATE_UPDATED: \"TEMPLATE_UPDATED\",\r\n  TEMPLATE_NEED_UPDATE: \"TEMPLATE_NEED_UPDATE\",\r\n  TEMPLATE_SAVING: \"TEMPLATE_SAVING\",\r\n  DEFAULT_BREAKPOINT: \"DEFAULT_BREAKPOINT\",\r\n  DEFAULT_AREAS: [\r\n    'content',\r\n    'footer',\r\n    'header',\r\n    'popup',\r\n    'email',\r\n    'card',\r\n    'reports',\r\n  ],\r\n  SCREENS: [\r\n    {\r\n      icon: \"wide_screen\",\r\n      name: \"DEFAULT_BREAKPOINT\",\r\n      id: 1,\r\n      width: \"100%\",\r\n      fullMediaQuery: \"\",\r\n      mediaQuery: \"\"\r\n    },\r\n    {\r\n      icon: \"desktop\",\r\n      name: \"Desktop\",\r\n      id: 2,\r\n      width: \"1440px\",\r\n      fullMediaQuery:\r\n        \"@media screen and (max-width: 1440px) and (min-width: 1025px)\",\r\n      mediaQuery: \"@media screen and (max-width: 1440px)\"\r\n    },\r\n    {\r\n      icon: \"laptop\",\r\n      name: \"Laptop\",\r\n      id: 3,\r\n      fullMediaQuery:\r\n        \"@media screen and (max-width: 1024px) and (min-width: 769px)\",\r\n      width: \"1024px\",\r\n      mediaQuery: \"@media screen and (max-width: 1024px)\"\r\n    },\r\n    {\r\n      icon: \"tablet\",\r\n      name: \"Tablet\",\r\n      id: 4,\r\n      fullMediaQuery:\r\n        \"@media screen and (max-width: 768px) and (min-width: 451px)\",\r\n      width: \"768px\",\r\n      mediaQuery: \"@media screen and (max-width: 768px)\"\r\n    },\r\n    {\r\n      icon: \"big_phone\",\r\n      name: \"Big-Phone\",\r\n      id: 5,\r\n      width: \"450px\",\r\n      fullMediaQuery:\r\n        \"@media screen and (max-width: 450px) and (min-width: 321px)\",\r\n      mediaQuery: \"@media screen and (max-width: 450px)\"\r\n    },\r\n    {\r\n      icon: \"small_phone\",\r\n      name: \"Small-Phone\",\r\n      id: 6,\r\n      fullMediaQuery: \"@media screen and (max-width: 320px)\",\r\n      width: \"320px\",\r\n      mediaQuery: \"@media screen and (max-width: 320px)\"\r\n    }\r\n  ]\r\n};\r\nexport default CONSTANTS;\r\n","export const ASSETS_SHOW = 'ASSETS_SHOW';\r\nexport const ASSETS_TOGGLE = 'ASSETS_TOGGLE';\r\n\r\nexport function assetsShow(settings) {\r\n  settings.active = true;\r\n  return {\r\n    type: ASSETS_SHOW,\r\n    settings\r\n  };\r\n}\r\n\r\nexport function assetsToggle() {\r\n  return {\r\n    type: ASSETS_TOGGLE,\r\n  };\r\n}\r\n\r\n","/**\r\n * @property {Int} id\r\n * @property {Object} data\r\n * */\r\nclass Template {\r\n\r\n}\r\n\r\nexport default Template","import Template from \"./Template\";\r\nimport {setAreas} from \"../store/areas/actions\";\r\n/**\r\n * @property {Template} template\r\n * @property {Object} settings\r\n * */\r\nclass Area {\r\n  static areaFactory(areaData) {\r\n    let area = new Area();\r\n    area.settings = areaData.settings;\r\n    area.id = areaData.id;\r\n    area.template = new Template();\r\n    area.template.data = areaData.template\r\n      ? areaData.template.data\r\n      : null;\r\n    if(_.isString(area.template.data)){\r\n      area.template.data = JSON.parse(area.template.data);\r\n    }\r\n    area.template.id = areaData.template ? areaData.template.id : null;\r\n    area.template.name =  areaData.template ?  areaData.template.name : '';\r\n    if (areaData.area_name === \"popups\") {\r\n      // area.templates = [];\r\n      // area.templates = new Template();\r\n      area.templates = [];\r\n      areaData.templates = areaData.templates || [];\r\n      areaData.templates.forEach(_t => {\r\n        let template = new Template();\r\n        template.data = _t ? _t.data : null;\r\n        if(_.isString(template.data)){\r\n          template.data = JSON.parse(template.data);\r\n        }\r\n        template.name = _t ? _t.name : '';\r\n        template.id = _t ? JSON.parse(_t.id) : null;\r\n        template.guid = _t ? _t.guid : null;\r\n        template.template_settings = _t ? _t.template_settings : [];\r\n        template.triggers = _t ? _t.triggers : {};\r\n        area.templates.push(template);\r\n      });\r\n    }\r\n    return area;\r\n  }\r\n\r\n  /**\r\n   * Массив шаблонов\r\n   * @return {*|Array}\r\n   */\r\n  getTemplates() {\r\n    this.templates = this.templates || [];\r\n    return this.templates;\r\n  }\r\n\r\n  /**\r\n   * Проверка является ли область пользовательской\r\n   * @return {boolean}\r\n   */\r\n  isCustomArea(){\r\n    return ! ! _.get(this.settings, 'area_type');\r\n  }\r\n  /**\r\n   * Проверка является ли область пользовательской\r\n   * @return {[string]}\r\n   */\r\n  getAreaClasses(){\r\n    if(this.CSSclasses){\r\n      return this.CSSclasses;\r\n    }\r\n    this.CSSclasses = [];\r\n    this.CSSclasses.push(`app-area_id-${this.id}`);\r\n    this.settings.sidebar_type && this.CSSclasses.push(`app-area_${this.settings.sidebar_type}`);\r\n    this.settings.sidebar_location && this.CSSclasses.push(`app-area_sidebar-location-${this.settings.sidebar_location}`);\r\n    return this.CSSclasses;\r\n  }\r\n\r\n  /**\r\n   * Получить пользовательские стили, если они есть\r\n   * @return {string}\r\n   */\r\n  getCustomCSS(){\r\n    let styles = '';\r\n\r\n    if(! _.isString(this.settings.custom_css)){\r\n      return styles;\r\n    }\r\n    styles = this.settings.custom_css.replace(/__selector__/g, `.app-area_id-${this.id}`);\r\n    return  styles;\r\n  }\r\n\r\n  /**\r\n   * Обновить значение настройки\r\n   */\r\n  setSetting(settingName, value){\r\n    if(this.getSetting(settingName) === value){\r\n      return;\r\n    }\r\n    _.set(this.settings, settingName, value);\r\n    if(this.component){\r\n      this.component.setState(state=>({...state, settings: {...this.settings}}))\r\n    }\r\n    if(window.currentRouteComponent){\r\n      window.currentRouteComponent.setState(state=>({...state, updateToken: Math.random()}));\r\n      appStore.dispatch(setAreas([...appStore.getState().areas]))\r\n    } else {\r\n      appStore.dispatch(setAreas([...appStore.getState().areas]))\r\n    }\r\n  }\r\n  /**\r\n   * Получить значение настройки\r\n   */\r\n  getSetting(settingName, _default){\r\n    return _.get(this.settings, settingName, _default);\r\n  }\r\n}\r\n\r\nexport default Area;\r\n","/**\r\n * @class Datasource\r\n */\r\nimport AltrpModel from \"../../../../editor/src/js/classes/AltrpModel\";\r\nimport {getDataByPath, isJSON, mbParseJSON} from \"../helpers\";\r\n\r\nclass Datasource extends AltrpModel{\r\n  /**\r\n   * получить url для вэба\r\n   * @return {string}\r\n   */\r\n  getWebUrl(){\r\n    return this.getProperty('source.web_url').replace(/{([\\s\\S]+?)}/g, '');\r\n  }\r\n  /**\r\n   * получить тип ресурса\r\n   * @return {string}\r\n   */\r\n  getType(){\r\n    return this.getProperty('source.type');\r\n  }\r\n  /**\r\n   * получить url для вэба\r\n   * @return {string}\r\n   */\r\n  getAlias(){\r\n    return this.getProperty('alias');\r\n  }\r\n\r\n  /**\r\n   * Получить параметры для запроса к ресурсу\r\n   * @params {{}} urlParams\r\n   * @params {string} excludePath - исключение из параметров, которые должны браться динамически\r\n   * @return{null | {}}\r\n   */\r\n  getParams(urlParams = {}, excludePath = ''){\r\n    const {currentModel, currentDataStorage} = appStore.getState();\r\n    let parsedTemplate = this.getProperty('parameters');\r\n    const params = {};\r\n    if(! parsedTemplate){\r\n      return null;\r\n    }\r\n    if(isJSON(parsedTemplate)){\r\n      parsedTemplate = mbParseJSON(parsedTemplate, []);\r\n      parsedTemplate = parsedTemplate.map(param=>{\r\n        return [param.paramName, param.paramValue];\r\n      });\r\n\r\n    } else {\r\n      parsedTemplate = parsedTemplate.split('\\n');\r\n      parsedTemplate = parsedTemplate.filter(line => line);\r\n      parsedTemplate = parsedTemplate.map(line=> {\r\n        line = line.split('|');\r\n        line[0] = line[0].trim();\r\n        if(line.length === 1){\r\n          line.push(line[0]);\r\n        } else {\r\n          line[1] = line[1].trim();\r\n        }\r\n        return line\r\n      });\r\n    }\r\n    parsedTemplate.forEach(([left, right])=>{\r\n      if(right.match(/{{([\\s\\S]+?)(?=}})/g)){\r\n        right = right.trim();\r\n        right = right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace('{{', '');\r\n        if(excludePath && right.indexOf(excludePath) === 0){\r\n          right = right;\r\n        } else {\r\n          right = getDataByPath(right);\r\n        }\r\n\r\n      }\r\n      if(right || right === 0){\r\n        params[left] = right;\r\n      }\r\n\r\n    });\r\n    return params;\r\n  }\r\n}\r\n\r\nexport default Datasource\r\n","/**\r\n * @property {Area[]} areas\r\n * */\r\nimport Area from \"./Area\";\r\nimport Datasource from \"./Datasource\";\r\n\r\nclass Route {\r\n  constructor(data) {\r\n    this.id = data.id;\r\n    this.path = data.path;\r\n    this.icon = data.icon;\r\n    this.model = data.model;\r\n    this.models = data.models;\r\n    this.parent_page_id = data.parent_page_id;\r\n    if (!this.models) {\r\n      this.models = data.model ? [data.model] : [];\r\n    }\r\n    this.model = data.model;\r\n    this.data_sources = data.data_sources || [];\r\n    this.data_sources = this.data_sources.map(\r\n      data_source => new Datasource(data_source)\r\n    );\r\n    this.title = data.title || \"\";\r\n    this.allowed = data.allowed;\r\n    this.redirect = data.redirect;\r\n    this.lazy = data.lazy;\r\n  }\r\n  static routeFabric(data) {\r\n    let route = new Route(data);\r\n    route.areas = [];\r\n    data.areas = data.areas || [];\r\n    for (let _area of data.areas) {\r\n      route.areas.push(Area.areaFactory(_area));\r\n    }\r\n    return route;\r\n  }\r\n}\r\n\r\nexport default Route;\r\n","\r\n\r\nclass AltrpSVG extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    window.assetsCache = window.assetsCache || {};\r\n    this.regex = new RegExp('[\\\\s\\\\r\\\\t\\\\n]*([a-z0-9\\\\-_]+)[\\\\s\\\\r\\\\t\\\\n]*=[\\\\s\\\\r\\\\t\\\\n]*([\\'\"])((?:\\\\\\\\\\\\2|(?!\\\\2).)*)\\\\2', 'ig'); //для работы с циклом\r\n\r\n    let _props = {};\r\n    let svg = '';\r\n    if(this.props.rawSVG){\r\n      window.assetsCache[this.props.url] = this.props.rawSVG;\r\n      svg = this.props.rawSVG;\r\n      let propsString = svg.match(/<svg(.*?)=\\\"(.*?)\\\">/gi)?svg.match(/<svg(.*?)=\\\"(.*?)\\\">/gi)[0] : '';\r\n\r\n      let match;\r\n      while (match = this.regex.exec(propsString)) {\r\n        _props[match[1]] = match[3];\r\n      }\r\n\r\n      svg = svg.replace(/<!--[\\s\\S]*?-->/g, '')\r\n      svg = svg.replace(/<![\\s\\S]*?>/g, '')\r\n      svg = svg.replace(/<\\?[\\s\\S]*?\\?>/g, '')\r\n      svg = svg.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, \"\");\r\n      // svg = svg.replace(/<svg[\\s\\S]*?>/gi, \"\").replace(/<\\/svg>/gi, \"\");\r\n    }\r\n    this.state = {\r\n      svg: svg || '',\r\n      props: _props,\r\n    };\r\n  }\r\n  async componentDidMount() {\r\n    window.assetsCache = window.assetsCache || {};\r\n    if(this.props.rawSVG){\r\n      window.assetsCache[this.props.url] = this.props.rawSVG;\r\n    }\r\n    if(! this.props.url){\r\n      return;\r\n    }\r\n    let content = (window.assetsCache[this.props.url]);\r\n\r\n    if(! content) {\r\n      let resource = new window.altrpHelpers.Resource({route: this.props.url});\r\n      content = await resource.getAsText();\r\n      window.assetsCache[this.props.url] = content;\r\n    }\r\n    let propsString = content.match(/<svg(.*?)=\\\"(.*?)\\\">/gi)?content.match(/<svg(.*?)=\\\"(.*?)\\\">/gi)[0] : '';\r\n    let props = {};\r\n    let match;\r\n    while (match = this.regex.exec(propsString)) {\r\n      props[match[1]] = match[3];\r\n    }\r\n    this.setState(state => ({...state, props}));\r\n\r\n    content = content.replace(/<!--[\\s\\S]*?-->/g, '')\r\n    content = content.replace(/<![\\s\\S]*?>/g, '')\r\n    content = content.replace(/<\\?[\\s\\S]*?\\?>/g, '')\r\n    content = content.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, \"\");\r\n    // content = content.replace(/<svg[\\s\\S]*?>/gi, \"\").replace(/<\\/svg>/gi, \"\");\r\n\r\n    this.setState(state=>({...state, svg: content}));\r\n  }\r\n\r\n  /**\r\n   * Обновиим если url в пропсах изменился\r\n   * @param prevProps\r\n   * @param prevState\r\n   */\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if(this.props.url !== prevProps.url){\r\n      this.componentDidMount();\r\n    }\r\n  }\r\n  render(){\r\n    let props = _.assign(this.state.props, this.props);\r\n    _.unset(props, 'url');\r\n    _.unset(props, 'rawSVG');\r\n    if(! this.state.svg){\r\n      return '';\r\n    }\r\n    let divElement;\r\n    let svg = '';\r\n    if(window.SSR){\r\n      divElement = parse(`<div>${this.state.svg}</div>`)\r\n      divElement.childNodes[1]?.removeAttribute('width')\r\n      divElement.childNodes[1]?.removeAttribute('height')\r\n      svg = divElement.childNodes[1]?.outerHTML;\r\n    } else {\r\n      divElement = document.createElement('div');\r\n      divElement.innerHTML = this.state.svg;\r\n      divElement.children[0]?.removeAttribute('width')\r\n      divElement.children[0]?.removeAttribute('height')\r\n      svg = divElement.children[0]?.outerHTML;\r\n    }\r\n    return <svg {...props}  dangerouslySetInnerHTML={{__html: svg || this.state.svg}}/>\r\n  }\r\n}\r\n\r\nexport default AltrpSVG;\r\n","import AltrpModel from \"../../../../../editor/src/js/classes/AltrpModel\";\r\n// import ArrayConverter from \"./ArrayConverter\";\r\n/**\r\n * @class DataConverter\r\n */\r\nclass DataConverter extends AltrpModel {\r\n  /**\r\n   * Изменяем данные\r\n   * если тип не соответствует, то возращаем исходные данные\r\n   * @param {*} data\r\n   * @return {*}\r\n   */\r\n  convertData(data) {\r\n    if (!this.checkData(data)) {\r\n      return data;\r\n    }\r\n    return this.doConvert(data);\r\n  }\r\n\r\n  /**\r\n   * Выполняем изменение данных\r\n   */\r\n  doConvert(data) {\r\n    const convertType = this.getConvertType();\r\n    if (_.isFunction(this[convertType])) {\r\n      return this[convertType](data);\r\n    }\r\n    return data;\r\n  }\r\n\r\n  checkData() {\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Тип получаемых данных\r\n   * @return {string}\r\n   */\r\n  getDataType() {\r\n    return this.getProperty(\"data_type\");\r\n  }\r\n  /**\r\n   * Тип получаемых данных\r\n   * @return {string}\r\n   */\r\n  getConvertType() {\r\n    return this.getProperty(\"convert_type\");\r\n  }\r\n  /**\r\n   * Тип получаемых данных\r\n   * @param {number} index\r\n   * @return {string}\r\n   */\r\n  getArgument(index = 1) {\r\n    return this.getProperty(`argument${index || 1}`);\r\n  }\r\n}\r\n\r\nexport default DataConverter;\r\n","import CONSTANTS from \"../../../editor/src/js/consts\";\nimport AltrpModel from \"../../../editor/src/js/classes/AltrpModel\";\nimport Resource from \"../../../editor/src/js/classes/Resource\";\nimport { changeCurrentUser } from \"./store/current-user/actions\";\nimport { changeCurrentUserProperty } from \"./store/current-user/actions\";\nimport { changeAppRoutes } from \"./store/routes/actions\";\nimport Route from \"./classes/Route\";\nimport { changePageState } from \"./store/altrp-page-state-storage/actions\";\nimport { changeAltrpMeta } from \"./store/altrp-meta-storage/actions\";\nimport queryString from \"query-string\";\nimport AltrpSVG from \"../../../editor/src/js/components/altrp-svg/AltrpSVG\";\nimport ArrayConverter from \"./classes/converters/ArrayConverter\";\nimport DataConverter from \"./classes/converters/DataConverter\";\nimport { changeFormFieldValue } from \"./store/forms-data-storage/actions\";\nimport { addResponseData } from \"./store/responses-storage/actions\";\nimport {getOffsetTopInElement} from \"./helpers/elements\";\nimport Area from \"./classes/Area\";\nimport {altrpFontsSet, GOOGLE_FONT} from \"./constants/fonts\";\nimport {addSettings} from \"./store/elements-settings/actions\";\nimport mutate from \"dot-prop-immutable\";\nexport function getRoutes() {\n\n  return import(/* webpackChunkName: 'Routes' */\"./classes/Routes.js\");\n}\n\nexport function isSSR(){\n  try {\n    return window.SSR;\n  } catch (e) {\n    return false;\n  }\n}\n/**\n * @return {IconsManager}\n * */\nexport function iconsManager() {\n  return window.iconsManager;\n}\n\n/**\n * Устанавливает заголовок страницы на фронтенде\n * @param {string} title\n */\nexport function setTitle(title) {\n  let titleElement = document.title;\n  if (!defaultTitle) {\n    defaultTitle = titleElement.innerHTML;\n  }\n  if (!title) {\n    title = defaultTitle;\n  }\n  if (document.title !== title) {\n    document.title = title;\n  }\n}\n\n/**\n * @return {boolean}\n * */\nexport function isEditor() {\n  const path = window.location?.pathname;\n  return path?.includes(\"/admin/editor\") || false;\n}\n\n/**\n * Переменная, в которой храниться изначальный заголовок\n * @let {string}\n */\nlet defaultTitle;\n\n/**\n * Парсит стрку вводимую пользователем для опций селекта\n * @param string\n */\nexport function parseOptionsFromSettings(string) {\n  if (!string) {\n    return [];\n  }\n  let options = string.split(\"\\n\");\n  let path = extractPathFromString(string);\n  let _optionsFromData = getDataByPath(path);\n  if (_.isArray(_optionsFromData)) {\n    return _optionsFromData;\n  }\n  options = options.map(option => {\n    let value = option.split(\"|\")[0];\n    value = value.trim();\n    let valuePath = extractPathFromString(value);\n    if (valuePath) {\n      value = getDataByPath(valuePath);\n    }\n    let label = option.split(\"|\")[1] || value || \"\";\n    !_.isString(label) && (label = \"\");\n    label = label.trim();\n    let labelPath = extractPathFromString(label);\n    if (labelPath) {\n      label = getDataByPath(labelPath);\n    }\n    return {\n      value,\n      label\n    };\n  });\n  return options;\n}\n\n/**\n * Получает медиа запрос для css по имени настройки\n * @param {string} screenSettingName\n * @return {string}\n */\nexport function getMediaQueryByName(screenSettingName) {\n  let mediaQuery = \"\";\n  CONSTANTS.SCREENS.forEach(screen => {\n    if (screen.name === screenSettingName) {\n      mediaQuery = screen.mediaQuery;\n    }\n  });\n  return mediaQuery;\n}\n/**\n * Получает медиа запрос для css по имени настройки\n * @param {string} screenSettingName\n * @return {string}\n */\nexport function getMediaSettingsByName(screenSettingName) {\n  let screen = CONSTANTS.SCREENS[0];\n  CONSTANTS.SCREENS.forEach(_screen => {\n    if (_screen.name === screenSettingName) {\n      screen = _screen;\n    }\n  });\n  return screen;\n}\n\n/**\n * Возвращает брейкпоинт относительно текущего размера экрана\n */\nexport function getCurrentBreakpoint() {\n  const currentWidth = getWindowWidth();\n  const breakPoints = CONSTANTS.SCREENS;\n  const breakPointsSizes = breakPoints.map(item => ({\n    name: item.name,\n    size: Number(item.width.split(\"px\")[0])\n  }));\n  for (let breakpoint of breakPointsSizes) {\n    if (breakpoint.size < currentWidth) {\n      return breakpoint.name;\n    }\n  }\n}\n/**\n *@param {string} URLTemplate\n *@param {{} | null} object\n */\nexport function parseURLTemplate(URLTemplate = \"\", object = null) {\n  let url = URLTemplate;\n  let protocol = \"\";\n  if (!isEditor()) {\n    object = _.assign(\n      _.cloneDeep(currentRouterMatch.getProperty(\"params\")),\n      object\n    );\n  }\n  url = url.trim();\n  if (url.indexOf(\"{{\") !== -1) {\n    url = replaceContentWithData(url, object);\n  }\n  if (url.indexOf(\"https://\") === 0) {\n    protocol = \"https://\";\n    url = url.replace(\"https://\", \"\");\n  }\n  if (url.indexOf(\"http://\") === 0) {\n    protocol = \"http://\";\n    url = url.replace(\"http://\", \"\");\n  }\n  if (url.indexOf(\"mailto:\") === 0) {\n    protocol = \"mailto:\";\n    url = url.replace(\"mailto:\", \"\");\n  }\n  if (url.indexOf(\"tel:\") === 0) {\n    protocol = \"tel:\";\n    url = url.replace(\"tel:\", \"\");\n  }\n  // columnEditUrl = columnEditUrl.replace(':id', row.original.id);\n  let idTemplates = url.match(/:([\\s\\S]+?)(\\/|$)/g);\n  if (!idTemplates) {\n    return protocol + url;\n  }\n  idTemplates.forEach(idTemplate => {\n    let replace = object[idTemplate.replace(/:|\\//g, \"\")] || \"\";\n    idTemplate = idTemplate.replace(\"/\", \"\");\n    url = url.replace(new RegExp(idTemplate, \"g\"), replace);\n  });\n  return protocol + url;\n}\n\nexport function getWindowWidth() {\n  let window;\n  if (isEditor()) {\n    window = document.getElementById(\"editorWindow\").offsetWidth;\n  } else {\n    window = document.getElementById(\"front-app\").offsetWidth;\n  }\n  return window;\n}\n\nexport function renderAssetIcon(asset, props = null) {\n  if (asset) {\n    if (asset.url && asset.type === \"svg\") {\n      return <AltrpSVG {...props} url={asset.url} />;\n    }\n    switch (asset.assetType) {\n      case \"icon\": {\n        return iconsManager().renderIcon(asset.name);\n      }\n      case \"image\": {\n        return React.createElement(\"img\", { ...props, src: asset.url });\n      }\n      case \"media\": {\n        return React.createElement(\"img\", { ...props, src: asset.url });\n      }\n    }\n  }\n  return \"\";\n}\n\n/**\n * @param {object} asset\n * @param {object} props\n * @return {React.DetailedReactHTMLElement<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement> | React.DetailedReactHTMLElement<React.HTMLAttributes<T>, HTMLElement> | React.ReactSVGElement | React.DOMElement<React.DOMAttributes<T>, Element> | React.FunctionComponentElement<{}> | React.CElement<{}, React.ClassicComponent<{}, React.ComponentState>> | React.CElement<{}, React.Component<P, React.ComponentState>> | React.ReactElement<{}> | string}\n * @throws Исключение если иконка не найдена\n * */\nexport function renderAsset(asset, props = null) {\n  if(_.isEmpty(asset)){\n    return  ''\n  }\n  if(asset.type === 'image' && asset.dataUrl){\n    return React.createElement(\"img\", {\n      ...props,\n      src: asset.dataUrl,\n    });\n  }\n  if (asset.url && asset.type === \"svg\") {\n    return <AltrpSVG {...props} url={asset.url} rawSVG={asset.rawSVG} />;\n  }\n  if (! isSSR() && asset instanceof File) {\n    let refImg = React.createRef();\n    let fr = new FileReader();\n    fr.readAsDataURL(asset);\n    fr.onload = () => {\n      if (refImg.current) {\n        refImg.current.src = fr.result;\n        refImg.current.alt = asset.name;\n      }\n    };\n    return React.createElement(\"img\", {\n      ...props,\n      src: asset.url,\n      ref: refImg\n    });\n  }\n  switch (asset.assetType) {\n    case \"icon\": {\n      return iconsManager().renderIcon(asset.name, props);\n    }\n    case \"image\": {\n      return React.createElement(\"img\", { ...props, src: asset.url });\n    }\n    case \"media\": {\n      return React.createElement(\"img\", { ...props, src: asset.url });\n    }\n    case \"mediaBackground\": {\n      return React.createElement(\"div\", {\n        ...props,\n        style: { backgroundImage: `url(${asset.url})` }\n      });\n    }\n    case undefined: {\n      return React.createElement(\"img\", {\n        ...props,\n        src: \"/img/nullImage.png\"\n      });\n    }\n  }\n  return \"\";\n}\n\n/**\n * Парсим данный из строки в объект, если значение - путь, то берем значение из context\n * (если в context нет свойства, то не записываем)\n * @param {string} string\n * @param {AltrpModel} context\n * @param {boolean} allowObject\n * @param {boolean} replaceRight - нужно ли подставлять в значение параметра данные или оставить сырой шаблон\n * @param {boolean} replace - нужно ли подставлять в значение параметра данные или оставить сырой шаблон\n * @return {{}}\n */\nexport function parseParamsFromString(\n  string,\n  context = {},\n  allowObject = false,\n  replaceRight = true,\n  replace = true,\n) {\n  if (!(context instanceof AltrpModel)) {\n    context = new AltrpModel(context);\n  }\n  const params = {};\n  const urlParams =\n    window.currentRouterMatch instanceof AltrpModel\n      ? window.currentRouterMatch.getProperty(\"params\")\n      : {};\n\n  if (!string) {\n    return params;\n  }\n  const lines = string.split(\"\\n\");\n  lines.forEach(line => {\n    let [left, right] = line.split(\"|\");\n    if (!left || !right) {\n      return;\n    }\n    left = left.trim();\n    right = right.trim();\n    if (replace && left.indexOf(\"{{\") !== -1) {\n      left = replaceContentWithData(left);\n    }\n    if (replace && right.match(/{{([\\s\\S]+?)(?=}})/g)) {\n      if (\n        context.getProperty(\n          right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\n        ) ||\n        getDataByPath(right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\"))\n      ) {\n        //todo ошибка в IOS\n        params[left] =\n          context.getProperty(\n            right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\n          ) ||\n          getDataByPath(\n            right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\n          ) ||\n          \"\";\n      } else {\n        replaceRight\n          ? (params[left] = urlParams[\n              right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\n            ]\n              ? urlParams[\n                  right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\n                ]\n              : \"\")\n          : (params[left] = right);\n      }\n    } else {\n      params[left] = right;\n    }\n    if (!allowObject && _.isObject(params[left])) {\n      delete params[left];\n    }\n  });\n  return params;\n}\n\n/**\n * Функция для проверки условий\n * @param {array} conditions\n * @param {boolean} AND - логичекое И или ИЛИ\n * @param {AltrpModel} model\n * @param {boolean} dataByPath - брать ли данные из getDataByPath\n * @return {boolean}\n */\nexport function conditionsChecker(\n  conditions = [],\n  AND = true,\n  model,\n  dataByPath = true\n) {\n  if (!conditions.length) {\n    return true;\n  }\n  let result = AND;\n  _.each(conditions, c => {\n    if (AND) {\n      result *= conditionChecker(c, model, dataByPath);\n    } else {\n      result += conditionChecker(c, model, dataByPath);\n    }\n  });\n  return !!result;\n}\n\n/**\n * Функция для проверки одного условия\n * @param c\n * @param {AltrpModel} model\n * @param {boolean} dataByPath - брать ли данный из getDataByPath\n * @return {boolean}\n */\nfunction conditionChecker(c, model, dataByPath = true) {\n  let result = 0;\n  const { operator } = c;\n  let { modelField: left, value } = c;\n  if (dataByPath) {\n    value = getDataByPath(value, \"\", model, true);\n    left = getDataByPath(left, \"\", model);\n    return altrpCompare(left, value, operator);\n  }\n  return altrpCompare(model.getProperty(left), value, operator);\n  switch (operator) {\n    case \"empty\": {\n      return !model.getProperty(modelField, \"\");\n    }\n    case \"not_empty\": {\n      return !!model.getProperty(modelField, \"\");\n    }\n    case \"==\": {\n      return _.isEqual(model.getProperty(modelField, \"\"), value);\n    }\n    case \"<>\": {\n      return !_.isEqual(model.getProperty(modelField, \"\"), value);\n    }\n    case \">\": {\n      return Number(model.getProperty(modelField, \"\")) > Number(value);\n    }\n    case \">=\": {\n      return Number(model.getProperty(modelField, \"\")) >= Number(value);\n    }\n    case \"<\": {\n      return Number(model.getProperty(modelField, \"\")) < Number(value);\n    }\n    case \"<=\": {\n      return Number(model.getProperty(modelField, \"\")) <= Number(value);\n    }\n  }\n  return result;\n}\n\n/**\n * Установить данные\n * @param {string} path\n * @param {*} value\n * @param {function | null} dispatch\n * @return {boolean}\n */\nexport function setDataByPath(path = \"\", value, dispatch = null) {\n  if (!path) {\n    return false;\n  }\n  if (path.indexOf(\",\") !== -1) {\n    let result = path\n      .split(\",\")\n      .map(path => setDataByPath(path, value, dispatch));\n    return true;\n  }\n  path = path.replace(\"{{\", \"\").replace(\"}}\", \"\");\n  path = path.trim();\n  switch (value) {\n    case \"true\":\n      value = true;\n      break;\n    case \"false\":\n      value = false;\n      break;\n    case \"null\":\n      value = null;\n      break;\n    case \"undefined\":\n      value = undefined;\n      break;\n  }\n\n  if (path.indexOf(\"altrppagestate.\") === 0) {\n    path = path.replace(\"altrppagestate.\", \"\");\n    if (!path) {\n      return false;\n    }\n    const oldValue = appStore.getState().altrpPageState.getProperty(path);\n    if (_.isEqual(oldValue, value)) {\n      return true;\n    }\n    if (_.isFunction(dispatch)) {\n      dispatch(changePageState(path, value));\n    } else {\n      appStore.dispatch(changePageState(path, value));\n    }\n    return true;\n  }\n  if (path.indexOf(\"altrpmeta.\") === 0) {\n    path = path.replace(\"altrpmeta.\", \"\");\n    if (!path) {\n      return false;\n    }\n    const oldValue = appStore.getState().altrpMeta.getProperty(path);\n    if (_.isEqual(oldValue, value)) {\n      return true;\n    }\n    if (_.isFunction(dispatch)) {\n      dispatch(changeAltrpMeta(path, value));\n    } else {\n      appStore.dispatch(changeAltrpMeta(path, value));\n    }\n    return true;\n  }\n  if (path.indexOf(\"altrpuser.local_storage.\") === 0) {\n    path = path.replace(\"altrpuser.\", \"\");\n    if (!path) {\n      return false;\n    }\n    const oldValue = appStore.getState().currentUser.getProperty(path);\n    if (_.isEqual(oldValue, value)) {\n      return true;\n    }\n    if (_.isFunction(dispatch)) {\n      dispatch(changeCurrentUserProperty(path, value));\n    } else {\n      appStore.dispatch(changeCurrentUserProperty(path, value));\n    }\n    return true;\n  }\n  if (path.indexOf(\"altrpforms.\") === 0) {\n    path = path.replace(\"altrpforms.\", \"\");\n    if (!path) {\n      return false;\n    }\n    const [formId, fieldName] = path.split(\".\");\n    const { formsStore } = appStore.getState();\n\n    const oldValue = _.get(formsStore, path);\n    if (_.isEqual(oldValue, value)) {\n      return true;\n    }\n    if (_.isFunction(dispatch)) {\n      dispatch(changeFormFieldValue(path, value));\n    } else {\n      appStore.dispatch(changeFormFieldValue(fieldName, value, formId, true));\n    }\n  } else\n  if (path.indexOf(\"altrpelements.\") === 0) {\n    const pathElements = path.split(\".\");\n    let [prefix, elementId, updateType, ...propName] = pathElements;\n    const component = getComponentByElementId(elementId);\n    if (!component) {\n      return true;\n    }\n    propName =  propName.join('.');\n    switch (updateType) {\n      case \"settings\": {\n        component.props.element.updateSetting(value, propName);\n        if(window['h-altrp']){\n          let settings = component.props.element.settings;\n          settings = mutate.set(settings, propName, value)\n          appStore.dispatch(addSettings(component.props.element.getId(), component.props.element.getName(), settings));\n        }\n        return true;\n      }\n      default: {\n        return true;\n      }\n    }\n  } else\n  if (path.indexOf(\"altrpareas.\") === 0) {\n    const pathElements = path.split(\".\");\n    const [prefix,  areaName,  updateType, propName] = pathElements;\n    let area = window.page_areas.find(area => area.id === areaName);\n    if(area && updateType === 'settings'){\n      if(! (area instanceof Area)){\n        area = Area.areaFactory(area);\n      }\n      area.setSetting(propName, value);\n    }\n  } else\n  if (path.indexOf(\"altrpstorage.\") === 0) {\n    path = path.replace(\"altrpstorage.\", \"\");\n    const currentStorage = getDataFromLocalStorage(\"altrpstorage\", {});\n    _.set(currentStorage, path, value);\n    saveDataToLocalStorage(\"altrpstorage\", currentStorage);\n    return true;\n  }\n  return false;\n}\n\n/**\n * Получить данные из окружения\n * @param {string} path\n * @param {*} _default\n * @param {{} | AltrpModel | null} context\n * @param {boolean} altrpCheck - проверять ли altrp\n * @return {*}\n */\nexport function getDataByPath(\n  path = \"\",\n  _default = null,\n  context = null,\n  altrpCheck = false\n) {\n  if (!path) {\n    return _default;\n  }\n  if (path.indexOf(\"{{\") !== -1) {\n    path = replaceContentWithData(path, context);\n  }\n  /**\n   * проверим путь\n   */\n  if (altrpCheck && path.trim().indexOf(\"altrp\") !== 0) {\n    return path;\n  }\n  path = path.trim();\n  let trueValue, falseValue;\n  if (path.indexOf(\"?\") !== -1 && path.indexOf(\":\") !== -1) {\n    let [_path, _right] = path.split(\"?\");\n    [trueValue, falseValue] = _right.split(\":\");\n    trueValue = trueValue.trim();\n    if (trueValue.indexOf(\".\") !== -1) {\n      trueValue = getDataByPath(trueValue, _default, context);\n    }\n\n    falseValue = falseValue.trim();\n    if (falseValue.indexOf(\".\") !== -1) {\n      falseValue = getDataByPath(falseValue, _default, context);\n    }\n    path = _path.trim();\n  }\n  /**\n   * @type {AltrpModel} currentModel\n   */\n  let {\n    currentModel,\n    currentDataStorage,\n    altrpresponses,\n    formsStore,\n    altrpPageState,\n    altrpPage,\n    currentUser,\n    altrpMeta\n  } = appStore.getState();\n  if (context) {\n    currentModel =\n      context instanceof AltrpModel ? context : new AltrpModel(context);\n  }\n  let urlParams =\n    window.currentRouterMatch instanceof AltrpModel\n      ? window.currentRouterMatch.getProperty(\"params\")\n      : {};\n\n  let queryData = queryString.parseUrl(window.location.href).query;\n\n  urlParams = _.assign(queryData, urlParams);\n\n  let value = _default;\n  if (!_.isString(path)) {\n    return value;\n  }\n  if (path.indexOf(\"altrpdata.\") === 0) {\n    path = path.replace(\"altrpdata.\", \"\");\n    value = currentDataStorage\n      ? currentDataStorage.getProperty(path, _default)\n      : \"\";\n  } else if (path.indexOf(\"altrpresponses.\") === 0) {\n    path = path.replace(\"altrpresponses.\", \"\");\n    value = altrpresponses ? altrpresponses.getProperty(path, _default) : \"\";\n  } else if (path.indexOf(\"altrpmeta.\") === 0) {\n    path = path.replace(\"altrpmeta.\", \"\");\n    value = altrpMeta ? altrpMeta.getProperty(path, _default) : \"\";\n  } else if (path.indexOf(\"altrppagestate.\") === 0) {\n    path = path.replace(\"altrppagestate.\", \"\");\n    value = altrpPageState ? altrpPageState.getProperty(path, _default) : \"\";\n  } else if (path.indexOf(\"altrpuser.\") === 0) {\n    path = path.replace(\"altrpuser.\", \"\");\n    value = currentUser ? currentUser.getProperty(path, _default) : \"\";\n  } else if (path === \"altrpuser\") {\n    value = currentUser.getData();\n  } else if (path === \"altrpmodel\") {\n    value = currentModel.getData();\n  } else if (path.indexOf(\"altrptime.\") === 0) {\n    value = getTimeValue(path.replace(\"altrptime.\", \"\"));\n  } else if (path.indexOf(\"altrpforms.\") === 0) {\n    value = _.get(formsStore, path.replace(\"altrpforms.\", \"\"), _default);\n  } else if (path.indexOf(\"altrppage.\") === 0) {\n    value = altrpPage\n      ? altrpPage.getProperty(path.replace(\"altrppage.\", \"\"), _default)\n      : \"\";\n  } else if (path.indexOf(\"altrpelements.\") === 0) {\n    const pathElements = path.split(\".\");\n    const [prefix, elementId, updateType, propName] = pathElements;\n    const component = getComponentByElementId(elementId);\n    if (!component) {\n      value = \"\";\n    } else {\n      switch (updateType) {\n        case \"settings\":\n          {\n            value = component.props.element.getSettings(propName);\n          }\n          break;\n        default: {\n          value = \"\";\n        }\n      }\n    }\n  } else if (path.indexOf(\"altrpstorage.\") === 0) {\n    path = path.replace(\"altrpstorage.\", \"\");\n    value = getDataFromLocalStorage(\"altrpstorage\", {});\n    value = _.get(value, path, _default);\n  } else if (path.indexOf(\"altrpareas.\") === 0) {\n    const pathElements = path.split(\".\");\n    const [prefix,  areaName,  updateType, propName] = pathElements;\n    let area = window.page_areas.find(area => area.id === areaName);\n    if(area && updateType === 'settings'){\n      if(! (area instanceof Area)){\n        area = Area.areaFactory(area);\n      }\n      value = area.getSetting(propName, _default);\n    }\n  } else {\n    value = currentModel.getProperty(path)\n      ? currentModel.getProperty(path)\n      : urlParams[path];\n    if (!value) {\n      value = _default;\n    }\n  }\n  if (trueValue || falseValue) {\n    value = value ? trueValue : falseValue;\n  }\n  return value;\n}\n\n/**\n * Извелкает путь из строки\n * @param {string} string\n * @return {string}\n */\nexport function extractPathFromString(string = \"\") {\n  let path = \"\";\n  if (_.isString(string)) {\n    // path = string.match(/(?<={{)([\\s\\S]+?)(?=}})/g)[0]\n    path = _.get(string.match(/{{([\\s\\S]+?)(?=}})/g), \"0\", \"\").replace(\n      \"{{\",\n      \"\"\n    );\n  }\n  return path;\n}\n/**\n * Возвращает новый объект из свояств объекта, в именах которых присутствует префикс prefix\n * @param {string} prefix - строка для поиска (например 'test')\n * @param {{}} object - если в объекте есть свойство test__test то вернет {test: test__test_value}\n * @return {{}}\n */\nexport function getObjectByPrefix(prefix = \"\", object = {}) {\n  let result = {};\n  if (!prefix) {\n    return result;\n  }\n  _.forEach(object, (value, key) => {\n    if (key.indexOf(`${prefix}__`, \"\") === 0) {\n      result[key.replace(`${prefix}__`, \"\")] = value;\n    }\n  });\n  return result;\n}\n\n/**\n * Возвращает объект из json-строки если возможно\n * @param {string} string\n * @param {*} _default\n * @return {*}\n */\nexport function mbParseJSON(string, _default = null) {\n  try {\n    return JSON.parse(string);\n  } catch (e) {\n    return _default === null ? string : _default;\n  }\n}\n\n/**\n * Функция для сравнения значений\n * @param leftValue\n * @param rightValue\n * @param operator\n * @return {boolean}\n */\nexport function altrpCompare(\n  leftValue = \"\",\n  rightValue = \"\",\n  operator = \"empty\"\n) {\n  switch (operator) {\n    case \"empty\": {\n      return _.isEmpty(leftValue);\n    }\n    case \"not_empty\": {\n      return !_.isEmpty(leftValue);\n    }\n    case \"null\": {\n      return !leftValue;\n    }\n    case \"not_null\": {\n      return !!leftValue;\n    }\n    case \"==\": {\n      if (!leftValue && !rightValue) {\n        return true;\n      }\n      if (!(_.isObject(leftValue) || _.isObject(rightValue))) {\n        return leftValue == rightValue;\n      } else {\n        return _.isEqual(leftValue, rightValue);\n      }\n    }\n    case \"===\": {\n      return _.isEqual(leftValue, rightValue);\n    }\n    case \"<>\": {\n      return !_.isEqual(leftValue, rightValue);\n    }\n    case \">\": {\n      return Number(leftValue) > Number(rightValue);\n    }\n    case \">=\": {\n      return Number(leftValue) >= Number(rightValue);\n    }\n    case \"<\": {\n      return Number(leftValue) < Number(rightValue);\n    }\n    case \"<=\": {\n      return Number(leftValue) <= Number(rightValue);\n    }\n    case \"in\": {\n      if (_.isString(rightValue)) {\n        return rightValue.indexOf(leftValue) !== -1;\n      }\n      if (!_.isArray(rightValue)) {\n        return false;\n      }\n      let result = false;\n      rightValue.forEach(item => {\n        if (!result) {\n          result = altrpCompare(leftValue, item, \"==\");\n        }\n      });\n      return result;\n    }\n    case \"not_in\": {\n      return !altrpCompare(leftValue, rightValue, \"in\");\n    }\n    case \"contain\": {\n      if (_.isString(leftValue)) {\n        return leftValue.indexOf(rightValue) !== -1;\n      }\n      if (!_.isArray(leftValue)) {\n        return false;\n      }\n      let result = false;\n      leftValue.forEach(item => {\n        if (!result) {\n          result = altrpCompare(rightValue, item, \"contain\");\n        }\n      });\n      return result;\n    }\n    case \"not_contain\": {\n      return !altrpCompare(leftValue, rightValue, \"contain\");\n    }\n  }\n}\n\nexport const CONDITIONS_OPTIONS = [\n  {\n    value: \"empty\",\n    label: \"Empty\"\n  },\n  {\n    value: \"not_empty\",\n    label: \"Not Empty\"\n  },\n  {\n    value: \"null\",\n    label: \"Null\"\n  },\n  {\n    value: \"not_null\",\n    label: \"Not Null\"\n  },\n  {\n    value: \"==\",\n    label: \"Equals\"\n  },\n  {\n    value: \"<>\",\n    label: \"Not Equals\"\n  },\n  {\n    value: \"between\",\n    label: \"Between\"\n  },\n  {\n    value: \">\",\n    label: \">\"\n  },\n  {\n    value: \">=\",\n    label: \">=\"\n  },\n  {\n    value: \"<\",\n    label: \"<\"\n  },\n  {\n    value: \"<=\",\n    label: \"<=\"\n  },\n  {\n    value: \"in\",\n    label: \"In\"\n  },\n  {\n    value: \"not_in\",\n    label: \"Not In\"\n  },\n  {\n    value: \"contain\",\n    label: \"Contain\"\n  },\n  {\n    value: \"not_contain\",\n    label: \"Not Contain\"\n  }\n];\n\nexport function isElementTopInViewport(top, scrollTop, clientHeight) {\n  return top > scrollTop && top < scrollTop + clientHeight;\n}\n\nexport function getTopPosition(element) {\n  let top = element.offsetTop;\n\n  while (element.offsetParent) {\n    element = element.offsetParent;\n    top += element.offsetTop;\n  }\n\n  return top;\n}\n\n/**\n * Получить какое-то время по шаблону `YYYY-MM-DD`\n * @param {string} path\n * @param {string | null} defaultValue\n */\nexport function getTimeValue(path, defaultValue = null) {\n  let value = defaultValue;\n\n  switch (path) {\n    case \"now\":\n      {\n        value = _.now();\n      }\n      break;\n    case \"month_start\":\n      {\n        value = startOfMonth(new Date());\n      }\n      break;\n    case \"prev_month_start\":\n      {\n        value = startOfMonth(new Date(), -1);\n      }\n      break;\n    case \"year_start\":\n      {\n        value = startOfYear(new Date());\n      }\n      break;\n    case \"prev_year_start\":\n      {\n        value = startOfYear(new Date(), -1);\n      }\n      break;\n    case \"prev_week_start\":\n      {\n        value = getPrevWeekStart();\n      }\n      break;\n    case \"next_week_start\":\n      {\n        value = getNextWeekStart();\n      }\n      break;\n    case \"week_start\":\n      {\n        value = getWeekStart();\n      }\n      break;\n  }\n  const {moment} = window.altrpHelpers;\n  value = moment(value).format(\"YYYY-MM-DD\");\n  return value;\n}\n\n/**\n * Получить начало месяца\n * @param {Date} date\n * @param {int} monthShift\n * @return {Date}\n */\nexport function startOfMonth(date, monthShift = 0) {\n  return new Date(date.getFullYear(), date.getMonth() + monthShift, 1);\n}\n/**\n * Получить начало месяца\n * @param {Date} date\n * @param {int} yearShift\n * @return {Date}\n */\nexport function startOfYear(date, yearShift = 0) {\n  return new Date(date.getFullYear() + yearShift, 0, 1);\n}\n/**\n * Получить начало месяца\n * @param {Date} date\n * @param {int} weekShift\n * @return {Date}\n */\nexport function startOfWeek(date, weekShift = 0) {\n  const {moment} = window.altrpHelpers;\n  return moment(\n    new Date(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate() + weekShift * 7\n    )\n  ).firstDayOfWeek();\n}\n\n/**\n * Получить ссылку на состояние хранилища\n * @return {*}\n */\nexport function getCurrentStoreState() {\n  return appStore.getState();\n}\n\n/**\n * Скроллит к элементу\n * @param {{} | HTMLElement}scrollbars\n * @param {{}}element\n */\nexport function scrollToElement(scrollbars, element) {\n  let { container } = scrollbars;\n  if(scrollbars instanceof HTMLElement){\n    container = scrollbars;\n    let scroll = getOffsetTopInElement(element, scrollbars);\n    if(scroll){\n      scrollbars.scrollTop =scroll;\n    }\n\n  }\n  /**\n   * @member {HTMLElement} container\n   */\n  if (!container) {\n    return;\n  }\n  if (!_.isFunction(scrollbars.scrollTop)) {\n    return;\n  }\n\n  let parent = element.offsetParent;\n  let top = element.offsetTop;\n\n  while (parent !== container) {\n    if (! parent) {\n      /**\n       * ушли в самый корень ДОМ и контейнер не встретился\n       */\n      return;\n    }\n    top += parent.offsetTop;\n    parent = parent.offsetParent;\n  }\n  /**\n   * не получили каеое-либо значение\n   */\n  if (! top) {\n    return;\n  }\n  scrollbars.scrollTop(top);\n}\n\n/**\n * Вернет HTML элемент React компонента, у которого id = elementId\n * @param {string} elementId\n * @return {null | HTMLElement}\n */\nexport function getHTMLElementById(elementId = \"\") {\n  let HTMLElement = null;\n  if (!elementId || !elementId.trim()) {\n    return HTMLElement;\n  }\n  elementId = elementId.trim();\n  appStore.getState().elements.forEach(el => {\n    if (!el.elementWrapperRef.current) {\n      return;\n    }\n    if (!el.elementWrapperRef.current.id) {\n      return;\n    }\n    if (\n      el.elementWrapperRef.current.id\n        .toString()\n        .split(\" \")\n        .indexOf(elementId) !== -1\n    ) {\n      HTMLElement = el.elementWrapperRef.current;\n    }\n  });\n  return HTMLElement;\n}\n\n/**\n * Вернет HTML  React компонента, у которого props.element = element\n * @param {FrontElement} element\n * @return {null | HTMLElement}\n */\nexport function getWrapperHTMLElementByElement(element) {\n  if (!element) {\n    return null;\n  }\n  let HTMLElement = null;\n  appStore.getState().elements.forEach(el => {\n    if (element === el.props.element) {\n      HTMLElement = el.elementWrapperRef.current;\n    }\n  });\n  return HTMLElement;\n}\n/**\n * Вернет HTML  React компонент, у которого elementWrapperRef.current.id = elementId\n * @param {string} elementId\n * @return {null | HTMLElement}\n */\nexport function getComponentByElementId(elementId = \"\") {\n  let component = null;\n  if (!elementId || !elementId.trim()) {\n    return component;\n  }\n  elementId = elementId.trim();\n  appStore.getState().elements.forEach(el => {\n    if (!el.elementWrapperRef.current) {\n      return;\n    }\n    if (!el.elementWrapperRef.current.id) {\n      return;\n    }\n    if (\n      el.elementWrapperRef.current.id\n        .toString()\n        .split(\" \")\n        .indexOf(elementId) !== -1\n    ) {\n      component = el;\n    }\n  });\n  return component;\n}\n\n/**\n * Начало следующей недели\n * @return {moment.Moment}\n */\nfunction getNextWeekStart() {\n  const {moment} = window.altrpHelpers;\n  let today = moment();\n  let daystoMonday = 7 - (today.isoWeekday() - 1);\n  return today.add(daystoMonday, \"days\");\n}\n\n/**\n * Начало текущей недели\n * @return {moment.Moment}\n */\nfunction getWeekStart() {\n  const {moment} = window.altrpHelpers;\n  let today = moment();\n  let daystoMonday = today.isoWeekday() - 1;\n  return today.subtract(daystoMonday, \"days\");\n}\n\n/**\n * Конец Следующей недели\n * @return {moment.Moment}\n */\nfunction getNextWeekEnd() {\n  let nextMonday = getNextWeekStart();\n  return nextMonday.add(\"days\", 6);\n}\n\n/**\n * Начало предыдущей недели\n * @return {moment.Moment}\n */\nfunction getPrevWeekStart() {\n  const {moment} = window.altrpHelpers;\n  let today = moment();\n  let daystoLastMonday = today.isoWeekday() - 1 + 7;\n  return today.subtract(daystoLastMonday, \"days\");\n}\n\n/**\n * Конец предыдущей недели\n * @return {moment.Moment}\n */\nfunction getPrevWeekEnd() {\n  let lastMonday = getPrevWeekStart();\n  return lastMonday.add(\"days\", 6);\n}\n\n/**\n * Удаляет пустые свойства в объектах\n */\nexport function clearEmptyProps() {}\n\n/**\n * Заменяет в тексте конструкции типа {{altrpdata...}} на данные\n * @param content\n * @param {{} | null} modelContext\n */\n\nexport function replaceContentWithData(content = \"\", modelContext = null) {\n  if(window.SSR){\n    return  content;\n  }\n  let paths = _.isString(content) ? content.match(/{{([\\s\\S]+?)(?=}})/g) : null;\n  if (_.isArray(paths)) {\n    paths.forEach(path => {\n      path = path.replace(\"{{\", \"\");\n      let value = getDataByPath(path, \"\", modelContext);\n      if (value === 0) {\n        value = \"0\";\n      }\n      path = escapeRegExp(path);\n      content = content.replace(new RegExp(`{{${path}}}`, \"g\"), value || \"\");\n    });\n  }\n  return content;\n}\n\n/**\n * Вспомогательные функции для работы с данными виджетов\n */\nwindow.altrphelpers = {\n  /**\n   * Возвращает сумму полей в массиве объектов\n   * @param {string}fieldName\n   * @return {number}\n   */\n  sumFields: function sumFields(fieldName) {\n    let sum = 0;\n    if (!_.isObject(this.context)) {\n      return sum;\n    }\n    if (!_.isArray(this.context)) {\n      this.context = [this.context];\n    }\n    this.context.forEach(c => {\n      sum += Number(_.get(c, fieldName)) || 0;\n    });\n    return sum;\n  }\n};\n\n/**\n * Функция выводит определенный элемент на печать\n * @params {HTMLElement[]} elements\n * @params {null || HTMLElement} stylesTag\n */\nexport function printElements(elements, title = \"\") {\n  let myWindow = window.open(\"\", \"my div\", \"height=400,width=1200\");\n  myWindow.document.write(`<html><head><title>${title}</title></head>`);\n  myWindow.document.write(\"<body >\");\n  elements = _.isArray(elements) ? elements : [elements];\n  let headContent = '';\n  myWindow.document.write(\"</body></html>\");\n  let bodyContent = '';\n  elements.forEach(element => {\n    if(element instanceof HTMLHeadElement){\n      headContent = element.innerHTML;\n      return\n    }\n    bodyContent += element.outerHTML;\n  });\n  myWindow.document.close(); // necessary for IE >= 10\n  myWindow.document.head.innerHTML = headContent;\n  bodyContent = bodyContent\n    .replace(/<tr/g, '<div className=\"altrp-table-tr\"')\n    .replace(/<th/g, '<div')\n    .replace(/<\\/tr>/g, '</div>')\n    .replace(/<\\/th>/g, '</div>')\n  myWindow.document.body.innerHTML = bodyContent;\n  myWindow.focus(); // necessary for IE >= 10\n  delay(250).then(()=>{\n    myWindow.print();\n    myWindow.close();\n  })\n  return true;\n}\n\n/**\n * Функция конвертирует HTML в PDF\n * @params {HTMLElement[]} element\n * @params {string} filename\n */\nexport async function elementsToPdf(elements, filename = \"\") {\n  let html2pdf = (await import(/* webpackChunkName: 'html2pdf' */\"html2pdf.js\")).default;\n  elements = elements.body ? elements.body : elements;\n  if (!elements) {\n    return {\n      success: true\n    };\n  }\n  let myWindow = window.open(\"\", \"my div\", \"height=400,width=1440\");\n  myWindow.document.write(`<html><head><title></title></head>`);\n  myWindow.document.write(\"</head><body >\");\n  elements = _.isArray(elements) ? elements : [elements];\n  elements.forEach(element => {\n    myWindow.document.write(element.outerHTML);\n  });\n  myWindow.document.write(\"</body></html>\");\n  return new Promise((resolve, reject) => {\n    html2pdf()\n      .from(myWindow.document.body)\n      .save(filename);\n    myWindow.close();\n    resolve({ success: true });\n  });\n}\n\n/**\n * Забирает данные из HTML таблицы\n * @param {{}}HTMLElement\n */\nexport function dataFromTable(HTMLElement) {\n  const data = [];\n  const headers = [];\n  if (!(HTMLElement && HTMLElement.querySelectorAll)) {\n    return data;\n  }\n  let table = HTMLElement.querySelector(\".altrp-table\");\n  if (!table && HTMLElement.querySelector(\".altrp-table-tr\")) {\n    table = HTMLElement;\n  }\n  if (!table) {\n    return data;\n  }\n  const ths = table.querySelectorAll(\".altrp-table-th\");\n  _.each(ths, th => {\n    // if (th.innerText) {\n    headers.push(th.innerText || \"\");\n    // }\n  });\n  const rows = table.querySelectorAll(\".altrp-table-tbody .altrp-table-tr\");\n  _.each(rows, row => {\n    const cells = row.querySelectorAll(\".altrp-table-td\");\n    const part = {};\n    headers.forEach((header, idx) => {\n      if (!header) {\n        return;\n      }\n      part[header] = cells[idx].innerText || \"\";\n    });\n    data.push(part);\n  });\n  return data;\n}\n\n/**\n * Создать csv-файл из данных и скачать\n * @param {{}} data\n * @param {string} filename\n */\nexport async function dataToCSV(data = {}, filename) {\n  filename = filename || \"File\";\n  if (!data) {\n    return { success: false };\n  }\n  if (_.isObject() && !_.isArray(data)) {\n    data = [data];\n  }\n  if (!_.isArray(data)) {\n    return { success: false };\n  }\n\n  let headers = _.toPairs(data[0]).map(([name, value]) => name);\n  let csvContent =\n    // 'data:text/csv;charset=utf-8,'\n    \"\" +\n    headers.join(\";\") +\n    \"\\n\" +\n    data\n      .map(item => {\n        let line = \"\";\n        headers.forEach((h, idx) => {\n          let value = _.get(item, h) || \"\";\n          if (_.isObject(value)) {\n            value = JSON.stringify(value);\n          }\n\n          line +=\n            (_.isString(value) ? value.replace(/\\s/g, \" \") : value) +\n            (headers.length === idx + 1 ? \"\" : \";\");\n        });\n        return line;\n      })\n      .join(\"\\n\");\n  let blob = new Blob([csvContent], {\n    type: \"text/csv\",\n    charset: \"windows-1251\"\n    // charset: 'utf-8',\n  });\n  let link = document.createElement(\"a\");\n  link.setAttribute(\"href\", window.URL.createObjectURL(blob));\n  link.setAttribute(\"download\", filename + \".csv\");\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  return { success: true };\n}\n\n/**\n * Генерация и загрузка XLS-файла\n * @param {Object data} Объект данных\n * @param {String} filename Имя файла\n */\nexport async function dataToXLS(data, filename = \"table\", templateName = \"\") {\n  const formData = new FormData();\n  formData.append(\"filename\", filename);\n  formData.append(\"data\", JSON.stringify(data));\n  formData.append(\"template\", templateName);\n\n  const response = await fetch(\"/api/export-excel\", {\n    method: \"POST\",\n    body: formData\n  });\n\n  return await response.blob();\n}\n\n/**\n * Генерация и загрузка XML-файла\n * @param {Object data} Объект данных\n * @param {String} filename Имя файла\n */\nexport async function dataToXML(data, filename = \"table\") {\n  const formData = new FormData();\n  formData.append(\"filename\", filename);\n  formData.append(\"data\", JSON.stringify(data));\n\n  const response = await fetch(\"/api/export-xml\", {\n    method: \"POST\",\n    body: formData\n  });\n\n  return await response.blob();\n}\n\n/**\n * Логиним пользователя\n * @param {{}} data\n * @param {string} formId\n * @return {Promise<{}>}\n */\nexport async function altrpLogin(data = {}, formId = \"login\") {\n  data.altrpLogin = true;\n  let res;\n  try {\n    res = await new Resource({ route: \"/login\" }).post(data);\n  } catch (error) {\n    let status = error.status;\n    if (error.res instanceof Promise) {\n      res = await error.res;\n    }\n    if (error instanceof Promise) {\n      res = await error;\n    }\n    res = mbParseJSON(res, {});\n    status && (res.__status = status);\n  }\n  appStore.dispatch(addResponseData(formId, res));\n  if (!(res.success || res._token)) {\n    return {\n      success: false\n    };\n  }\n  _token = res._token;\n\n  let currentUser = await new Resource({\n    route: \"/ajax/current-user\"\n  }).getAll();\n  currentUser = currentUser.data;\n  appStore.dispatch(changeCurrentUser(currentUser));\n  let routes = [];\n  try {\n    let routesData = await new Resource({\n      route: \"/ajax/routes\"\n    }).getAll();\n\n    for (let _data of routesData.pages) {\n      routes.push(Route.routeFabric(_data));\n    }\n    appStore.dispatch(changeAppRoutes(routes));\n  } catch (err) {\n    console.error(err);\n    return { success: false };\n  }\n  return { success: true };\n}\n\n/**\n * Выход\n * @return {Promise<{}>}\n */\nexport async function altrpLogout() {\n  let res = await new Resource({ route: \"/logout\" }).post();\n  if (!(res.success || res._token)) {\n    return {\n      success: false\n    };\n  }\n  _token = res._token;\n\n  let currentUser = await new Resource({\n    route: \"/ajax/current-user\"\n  }).getAll();\n  currentUser = currentUser.data;\n  appStore.dispatch(changeCurrentUser(currentUser));\n  let routes = [];\n  try {\n    let routesData = await new Resource({\n      route: \"/ajax/routes\"\n    }).getAll();\n\n    for (let _data of routesData.pages) {\n      routes.push(Route.routeFabric(_data));\n    }\n    appStore.dispatch(changeAppRoutes(routes));\n  } catch (err) {\n    console.error(err);\n    return { success: false };\n  }\n  return { success: true };\n}\n\nexport function cutString(string, maxLength = 80) {\n  if (string.length <= maxLength) return string;\n  return string.slice(0, maxLength) + \"...\";\n}\n\nexport function sortOptions(options, sortDirection) {\n  options.sort((a, b) =>\n    a.label.toLowerCase() > b.label.toLowerCase()\n      ? 1\n      : b.label.toLowerCase() > a.label.toLowerCase()\n      ? -1\n      : 0\n  );\n  return sortDirection === \"asc\" ? options : options.reverse();\n}\n/**\n * рекурсивно считает общую длину по пути\n * @param {{}} object\n * @param {string} path\n * @return {number}\n */\nexport function recurseCount(object = {}, path = \"\") {\n  let count = 0;\n  if (!path) {\n    return count;\n  }\n  let array = _.get(object, path, []);\n  if (!array.length) {\n    count++;\n    return count;\n  }\n  array.forEach(item => {\n    count += recurseCount(item, path);\n  });\n  return count;\n}\n\n/**\n * Вовращает AltrpModel, в котором храняться все источники данных на странице\n * @param {{}} model\n * @return {AltrpModel}\n */\nexport function getAppContext(model = null) {\n  const { currentModel } = appStore.getState();\n  if(model instanceof AltrpModel){\n    model = model.getData();\n  }\n  const currentModelData = model ? model : currentModel.getData();\n  const urlParams = _.cloneDeep(\n    window.currentRouterMatch instanceof AltrpModel\n      ? window.currentRouterMatch.getProperty(\"params\")\n      : {}\n  );\n  const context = new AltrpModel(_.assign(urlParams, currentModelData));\n  const {\n    altrpPageState,\n    altrpPage,\n    altrpMeta,\n    currentDataStorage,\n    currentUser,\n    altrpresponses,\n    formsStore\n  } = appStore.getState();\n\n  context.setProperty(\"altrpdata\", currentDataStorage);\n  context.setProperty(\"altrppagestate\", altrpPageState);\n  context.setProperty(\"altrpmeta\", altrpMeta);\n  context.setProperty(\"altrpuser\", currentUser);\n  context.setProperty(\"altrpresponses\", altrpresponses);\n  context.setProperty(\"altrpforms\", formsStore);\n  context.setProperty(\"altrppage\", altrpPage);\n  return context;\n}\n\n/**\n * Сохраняет состояние виджет в localStorage\n * Для виджетов ,которые могут сохранять состояния при смене страниц\n * @param {string} widgetId\n * @param {*} state\n * @return {boolean}\n */\nexport function storeWidgetState(widgetId, state = null) {\n  if (!widgetId) {\n    return false;\n  }\n  const path = `widget_state${widgetId}`;\n  return saveDataToLocalStorage(path, state);\n}\n/**\n * Забирает состояние из localStorage\n * Для виджетов ,которые могут сохранять состояния при смене страниц\n * @param {string} widgetId\n * @param {*} _default\n * @return {boolean}\n */\nexport function getWidgetState(widgetId, _default = null) {\n  if (!widgetId) {\n    return _default;\n  }\n  const path = `widget_state${widgetId}`;\n  return getDataFromLocalStorage(path, _default);\n}\n\n/**\n * Сохранить данные в localStorage\n * @param {string} name\n * @param {*} data\n * @return {boolean}\n */\nexport function saveDataToLocalStorage(name, data) {\n  if (!name) {\n    return false;\n  }\n  if (_.isObject(data)) {\n    data = JSON.stringify(data);\n  }\n  try {\n    localStorage.setItem(name, data);\n  } catch (e) {\n    return true;\n  }\n  return true;\n}\n/**\n * Сохранить данные в localStorage\n * @param {string} name\n * @param {*} _default\n * @return {*}\n */\nexport function getDataFromLocalStorage(name, _default = undefined) {\n  if (!name) {\n    return _default;\n  }\n  let value\n  try {\n    value = localStorage.getItem(name);\n    if (!value) {\n      return _default;\n    }\n    value = JSON.parse(value);\n  } catch (error) {\n  }\n  if (_.isString(value) && Number(value)) {\n    value = Number(value);\n  }\n  return value || _default;\n}\nexport function scrollbarWidth() {\n  // thanks too https://davidwalsh.name/detect-scrollbar-width\n  const scrollDiv = document.createElement(\"div\");\n  scrollDiv.setAttribute(\n    \"style\",\n    \"width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;\"\n  );\n  document.body.appendChild(scrollDiv);\n  const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n  document.body.removeChild(scrollDiv);\n  return scrollbarWidth;\n}\n\n/**\n * Добавляем свойство altrpIndex для всех эементов-объектов массива\n * для их идентификации внутри повторяющихся карточек\n * @param {[]} array\n */\nexport function setAltrpIndex(array = []) {\n  if (!_.isArray(array)) {\n    return;\n  }\n  array.forEach((item, idx) => {\n    if (!_.isObject(item)) {\n      return;\n    }\n    if (item instanceof AltrpModel) {\n      item.setProperty(\"altrpIndex\", idx);\n      return;\n    }\n    item.altrpIndex = idx;\n  });\n}\n\n/**\n *\n * @param {string} font\n * @return {*}\n */\nexport function renderFontLink(font) {\n  if (altrpFontsSet[font] !== GOOGLE_FONT) {\n    return null;\n  }\n  font = font.replace(/ /g, \"+\");\n  font +=\n    \":100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic\";\n  let fontUrl =\n    \"https://fonts.googleapis.com/css?family=\" + font + \"&subset=cyrillic\";\n  fontUrl = encodeURI(fontUrl);\n  return <link rel=\"stylesheet\" key={fontUrl} href={fontUrl} />;\n}\n\n/**\n * Включен ли режим тестирования\n */\nexport function isAltrpTestMode() {\n  return window.location.href.indexOf(\"altrp-test=true\") > 0;\n}\n\n/**\n * случайная строка\n * @return {string}\n */\nexport function altrpRandomId() {\n  return Math.random()\n    .toString(36)\n    .substr(2, 9);\n}\n\n/**\n * Кнопки для пагинации\n * @param pageIndex\n * @param pageCount\n * @param first_last_buttons_count\n * @param middle_buttons_count\n * @return {*[]}\n */\nexport function generateButtonsArray(\n  pageIndex,\n  pageCount,\n  first_last_buttons_count,\n  middle_buttons_count\n) {\n  const buttonsSum = first_last_buttons_count + middle_buttons_count;\n  const lastButtons = Array.from(\n    { length: first_last_buttons_count },\n    (_, i) => pageCount - i - 1\n  ).reverse();\n  const middleButtons = Array.from(\n    { length: middle_buttons_count },\n    (_, i) => pageIndex - Math.floor(middle_buttons_count / 2) + i\n  );\n\n  if (pageIndex + 1 < buttonsSum) {\n    return [...Array(buttonsSum).keys(), \"ellipsis\", ...lastButtons];\n  }\n  if (\n    pageIndex >=\n    pageCount -\n      first_last_buttons_count -\n      1 -\n      Math.floor(middle_buttons_count / 2)\n  ) {\n    return [\n      ...Array(first_last_buttons_count).keys(),\n      \"ellipsis\",\n      ...Array.from(\n        { length: first_last_buttons_count + middle_buttons_count },\n        (_, i) => pageCount - i - 1\n      ).reverse()\n    ];\n  }\n\n  return [\n    ...Array(first_last_buttons_count).keys(),\n    \"ellipsis\",\n    ...middleButtons,\n    \"ellipsis\",\n    ...lastButtons\n  ];\n}\n\n/**\n * Проверяем текст на соответствие маске\n * @param {string} value\n * @param {[]} mask\n * @return {boolean}\n */\nexport function isValueMatchMask(value, mask) {\n  if (!value || value.length !== mask.length) {\n    return false;\n  }\n  return (\n    value.length &&\n    value\n      .split(\"\")\n      .every((char, index) => char === mask[index] || char.match(mask[index]))\n  );\n}\n\n/**\n * Вернуть экземпляр конвертера необходимого типа (array - ArrayConverter и т. д.)\n * @return {DataConverter}\n */\nexport function getConverter(data) {\n  switch (data.data_type) {\n    case \"array\":\n      return new ArrayConverter(data);\n  }\n  return new DataConverter();\n}\n\n/**\n * Конвертируются данные\n * @param {{} | []} settings\n * @param {*} data\n */\nexport function convertData(settings, data) {\n  if (_.isArray(settings)) {\n    settings.forEach(item => {\n      const converter = getConverter(item);\n      data = converter.convertData(data);\n    });\n  }\n  if (settings.data_type) {\n    const converter = getConverter(settings);\n    data = converter.convertData(data);\n  }\n  return data;\n}\nexport function renderIcon(isHidden, icon, defaultIcon, className) {\n  if (isHidden) return null;\n\n  return (\n    <span className={className}>\n      {icon && icon.assetType ? renderAssetIcon(icon) : defaultIcon}\n    </span>\n  );\n  // if()\n}\n\n/**\n * Перенаправление на другую страницу по настройкам LinkController\n * @param {{}} linkSettings\n * @param {{}} e\n * @param {{}} context\n */\nexport function redirect(linkSettings, e, context = {}) {\n  if (_.get(linkSettings, \"toPrevPage\")) {\n    if(window.frontAppRouter){\n      frontAppRouter.history.goBack();\n    } else {\n      history.back();\n    }\n    return;\n  }\n  if (!_.get(linkSettings, \"url\")) {\n    return;\n  }\n  e.preventDefault();\n  e.stopPropagation();\n  let { url } = linkSettings;\n  url = replaceContentWithData(url, context);\n  if (linkSettings.openInNew) {\n    window.open(url, \"_blank\");\n    return;\n  }\n  if (linkSettings.tag === \"a\" || ! window.frontAppRouter) {\n    window.location.assign(url);\n  } else {\n    frontAppRouter.history.push(url);\n  }\n\n}\n\nexport function validateEmail(email) {\n  const re = /^(([^<>()[\\]\\\\.,;:\\s@']+(\\.[^<>()[\\]\\\\.,;:\\s@']+)*)|('.+'))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return re.test(String(email).toLowerCase());\n}\n\n/**\n * значение настройки в зависимости от разрешения можно использовать вне виджетов с объектом настроек\n * @param {{}} settings - объект настроек\n * @param {string} settingName\n * @param {string} elementState\n * @param {*} _default\n * @return {*}\n */\nexport function getResponsiveSetting(\n  settings,\n  settingName,\n  elementState = \"\",\n  _default = null\n) {\n  let  currentScreen\n  try{\n    currentScreen = window.parent.appStore.getState().currentScreen\n  } catch(e){\n    console.trace(e);\n    currentScreen = window.appStore.getState().currentScreen\n  }\n  let _settingName = `${settingName}_${elementState}_`;\n  if (currentScreen.name === CONSTANTS.DEFAULT_BREAKPOINT) {\n    let setting = settings[_settingName];\n\n    if (setting === undefined) {\n      if(elementState){\n        return undefined\n      }\n      setting = _.get(settings, settingName, _default);\n    }\n    return setting;\n  }\n  let suffix = currentScreen.name;\n  _settingName = `${settingName}_${elementState}_${suffix}`;\n  let setting = settings[_settingName];\n  if (setting === undefined) {\n    for (let screen of [...CONSTANTS.SCREENS].reverse()) {\n      if (\n        currentScreen.id < screen.id ||\n        screen.name === CONSTANTS.DEFAULT_BREAKPOINT\n      ) {\n        continue;\n      }\n\n      _settingName = `${settingName}_${elementState}_${screen.name}`;\n\n      if (settings[_settingName] !== undefined) {\n        setting = settings[_settingName];\n        break;\n      }\n    }\n  }\n\n\n\n  if (setting === undefined) {\n    if(elementState){\n      return undefined\n    }\n    setting = _.get(settings, settingName, _default);\n  }\n  return setting;\n}\n\n/**\n * Заменяет false, null, true в строке на соответствующие значения\n * @param {string} value\n * @return {*}\n */\nexport function valueReplacement(value) {\n  switch (value) {\n    case \"true\":\n      return true;\n    case \"false\":\n      return false;\n    case \"null\":\n      return null;\n  }\n  return value;\n}\n\n/**\n * Задержка и с интерфейсом промиса\n * @param ms\n * @return {Promise}\n */\nexport function delay(ms) {\n  if (_.isString(ms)) {\n    ms = Number(ms);\n  }\n  return new Promise((resolve, reject) => {\n    setTimeout(resolve, ms);\n  });\n}\n\n/**\n * Подготавливает URL для шаблона письма\n * @param {string} url\n * @param {{} | null} context\n * @return {string}\n */\nexport function prepareURLForEmail(url, context = null) {\n  if (!_.isString(url) || !url) {\n    return url;\n  }\n  url = url.trim();\n  if (url.indexOf(\"http\") !== 0) {\n    url = location.origin + url;\n  }\n  return parseURLTemplate(url, context);\n}\n\nexport function parseIDFromYoutubeURL(youtubeURL) {\n  const startIndex = youtubeURL.indexOf(\"v=\") + 2;\n  const endIndex = youtubeURL.indexOf(\"&\", startIndex);\n\n  return youtubeURL.substring(startIndex, endIndex);\n}\n\n/**\n *\n * @param {{}} context\n * @return {{}}\n */\nexport function prepareContext(context) {\n  context.altrpdata = appStore.getState().currentDataStorage.getData();\n  context.altrpmodel = appStore.getState().currentModel.getData();\n  context.altrpuser = appStore.getState().currentUser.getData();\n  context.altrppagestate = appStore.getState().altrpPageState.getData();\n  context.altrpresponses = appStore.getState().altrpresponses.getData();\n  context.altrpmeta = appStore.getState().altrpMeta.getData();\n  return context;\n}\n\n/**\n *\n * Определеят явлется ли строка валидным JSON\n * @param {string} JSONString\n * @return {boolean}\n */\nexport function isJSON(JSONString = \"\") {\n  try {\n    JSON.parse(JSONString);\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n\n/**\n * Парсит xml строку в объект\n * @param xml\n * @param arrayTags\n */\nfunction parseXml(xml, arrayTags) {\n  let dom = null;\n  if (window.DOMParser) dom = new DOMParser().parseFromString(xml, \"text/xml\");\n  else if (window.ActiveXObject) {\n    dom = new ActiveXObject(\"Microsoft.XMLDOM\");\n    dom.async = false;\n    if (!dom.loadXML(xml))\n      throw dom.parseError.reason + \" \" + dom.parseError.srcText;\n  } else throw new Error(\"cannot parse xml string!\");\n\n  function parseNode(xmlNode, result) {\n    if (xmlNode.nodeName === \"#text\") {\n      let v = xmlNode.nodeValue;\n      if (v.trim()) result[\"#text\"] = v;\n      return;\n    }\n\n    let jsonNode = {},\n      existing = result[xmlNode.nodeName];\n    if (existing) {\n      if (!Array.isArray(existing))\n        result[xmlNode.nodeName] = [existing, jsonNode];\n      else result[xmlNode.nodeName].push(jsonNode);\n    } else {\n      if (arrayTags && arrayTags.indexOf(xmlNode.nodeName) !== -1)\n        result[xmlNode.nodeName] = [jsonNode];\n      else result[xmlNode.nodeName] = jsonNode;\n    }\n\n    if (xmlNode.attributes)\n      for (let attribute of xmlNode.attributes)\n        jsonNode[attribute.nodeName] = attribute.nodeValue;\n\n    for (let node of xmlNode.childNodes) parseNode(node, jsonNode);\n  }\n\n  let result = {};\n  for (let node of dom.childNodes) parseNode(node, result);\n\n  return result;\n}\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"); // $& means the whole matched string\n}\n\n/**\n * Вернуть значение из строки\n * @param string\n */\nexport function parseStringValue(string) {\n  let value = string;\n\n  if (Number(value)) {\n    return Number(value);\n  }\n  switch (value) {\n    case \"true\": {\n      return true;\n    }\n    case \"false\": {\n      return false;\n    }\n    case \"null\": {\n      return null;\n    }\n    case \"undefined\": {\n      return undefined;\n    }\n    case \"0\": {\n      return 0;\n    }\n  }\n  return value;\n}\n\n/**\n *\n * @return {*[]}\n */\nexport function getBreadcrumbsItems(){\n  if(window['h-altrp'] && window.breadcrumbsItems){\n    return window.breadcrumbsItems;\n  }\n  let items = [];\n  if(isEditor(0)){\n    return items;\n  }\n  const currentId = window['h-altrp'] ? window.page_id : window.currentPageId\n  const {routes} = appStore.getState().appRoutes\n  let breadcrumbsClone = [];\n  let idCurrent = 0;\n  routes.forEach((route, idx) => {\n    if(currentId === route.id) {\n      idCurrent = idx\n    }\n  })\n\n  breadcrumbsClone.push(routes[idCurrent])\n\n  function getParent(parentId) {\n    routes.forEach(route => {\n      if(route.id === parentId) {\n        breadcrumbsClone.push(route)\n        if(route.parent_page_id) {\n          getParent(route.parent_page_id)\n        }\n      }\n    })\n  }\n\n  if(routes[idCurrent].parent_page_id) {\n    getParent(routes[idCurrent].parent_page_id)\n  }\n\n  items = breadcrumbsClone.reverse()\n  if(window['h-altrp']){\n    window.breadcrumbsItems = items;\n  }\n  return items;\n}\n","export const SET_AREAS = 'SET_AREAS';\r\n\r\n/**\r\n *\r\n * @param {Area[]} areas\r\n * @return {{}} - {\r\n *     type: {string},\r\n *     areas: {Area[]},\r\n *   }\r\n */\r\nexport function setAreas(areas) {\r\n  return {\r\n    type: SET_AREAS,\r\n    areas,\r\n  };\r\n}\r\n","export const CHANGE_CURRENT_USER = 'CHANGE_CURRENT_USER';\r\nexport const SET_NOTICE_FOR_USER = 'SET_NOTICE_FOR_USER';\r\nexport const SET_USERS_ONLINE = 'SET_USERS_ONLINE';\r\nexport const CHANGE_CURRENT_USER_PROPERTY = \"CHANGE_CURRENT_USER_PROPERTY\";\r\n\r\nexport function changeCurrentUser(user) {\r\n  return {\r\n    type: CHANGE_CURRENT_USER,\r\n    user: user || {}\r\n  };\r\n}\r\n\r\nexport function setUserNotice(notice){\r\n  return { type: SET_NOTICE_FOR_USER, notice }\r\n}\r\n\r\nexport function setUsersOnline(members){\r\n  return { type: SET_USERS_ONLINE, members }\r\n}\r\n\r\nexport function changeCurrentUserProperty(path, value) {\r\n  return {\r\n    type: CHANGE_CURRENT_USER_PROPERTY,\r\n    path: path || \"\",\r\n    value: value || \"\"\r\n  };\r\n}\r\n","/**\r\n * Имеет интерфейс пользователя\r\n * @class AltrpUser\r\n */\r\n\r\nimport AltrpModel from \"./AltrpModel\";\r\n\r\nclass AltrpUser extends AltrpModel{\r\n  /**\r\n   * Проверяет является ли пользователь гостем\r\n   * @return {boolean}\r\n   */\r\n  isGuest(){\r\n    return this.getProperty('is_guest', false)\r\n  }\r\n  /**\r\n   * Проверяет является ли авторизованным пользователем\r\n   * @return {boolean}\r\n   */\r\n  isAuth(){\r\n    return this.getProperty('created_at', false)\r\n  }\r\n\r\n  /**\r\n   * Проверяет наличие permission у пользователя\r\n   * @param {array} permissions\r\n   * $return {boolean}\r\n   */\r\n  hasPermissions(permissions = []){\r\n    if(! _.isArray(permissions)){\r\n      permissions = [permissions];\r\n    }\r\n    let ownPermissions = this.getProperty('permissions', []);\r\n    return _.find(ownPermissions, ownPermission => {\r\n      return _.find(permissions, permission => {\r\n        if(parseInt(permission)){\r\n          return parseInt(permission) === parseInt(ownPermission.id);\r\n        }\r\n        if(_.isString(permission)){\r\n          return permission === ownPermission.name;\r\n        }\r\n      });\r\n    });\r\n  }\r\n  /**\r\n   * Проверяет наличие роли у пользователя\r\n   * @param {array} roles\r\n   * $return {boolean}\r\n   */\r\n  hasRoles(roles = []){\r\n    if(! _.isArray(roles)){\r\n      roles = [roles];\r\n    }\r\n    let ownRoles = this.getProperty('roles', []);\r\n    return _.find(ownRoles, ownRole => {\r\n      return _.find(roles, role => {\r\n        if(parseInt(role)){\r\n          return parseInt(role) === parseInt(ownRole.id);\r\n        }\r\n        if(_.isString(role)){\r\n          return role === ownRole.name;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Проверяет доступ пользователя по необходимым роля и разрешениям\r\n   * @param {array} permissions\r\n   * @param {array} roles\r\n   * $return {boolean}\r\n   *\r\n   */\r\n  checkUserAllowed(permissions = [], roles = []){\r\n    if(! this.isAuth()){\r\n      return false;\r\n    }\r\n    roles = _.isArray(roles) ? roles : [];\r\n    permissions = _.isArray(permissions) ? permissions : [];\r\n    if(! (permissions.length || roles.length)){\r\n      return true;\r\n    }\r\n    if(this.hasPermissions(permissions)){\r\n      return true;\r\n    }\r\n    if(this.hasRoles(roles)){\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default AltrpUser","import {\r\n  changeCurrentUser,\r\n  changeUpdateUserNotification,\r\n  CHANGE_CURRENT_USER,\r\n  SET_USERS_ONLINE,\r\n  CHANGE_CURRENT_USER_PROPERTY,\r\n  SET_NOTICE_FOR_USER,\r\n} from \"./actions\";\r\nimport AltrpUser from \"../../../../../editor/src/js/classes/AltrpUser\";\r\nimport Resource from \"../../../../../editor/src/js/classes/Resource\";\r\n\r\nconst defaultModel = window.current_user || {};\r\nexport function currentUserReducer(user, action) {\r\n  user = user || defaultModel;\r\n  let localStorage = action.user?.local_storage;\r\n  switch (action.type) {\r\n    case CHANGE_CURRENT_USER:\r\n      {\r\n        user = action.user;\r\n        if (Array.isArray(user.local_storage)) {\r\n          user.local_storage = {};\r\n        }\r\n      }\r\n      break;\r\n    case CHANGE_CURRENT_USER_PROPERTY:\r\n      {\r\n        let path = action.path;\r\n        let value = action.value;\r\n        user.setProperty(path, value);\r\n        const data = _.cloneDeep(user.getProperty(\"local_storage\"));\r\n        const form = {\r\n          local_storage: data\r\n        };\r\n        new Resource({ route: `/ajax/current-user` })\r\n          .put(\"\", form)\r\n          .then(res => {\r\n            appStore.dispatch(changeCurrentUser(res.data));\r\n          })\r\n          .catch(error => console.error(error));\r\n      }\r\n      break;\r\n    case SET_NOTICE_FOR_USER:\r\n      {\r\n        let newNotice = action.notice;\r\n        user = { ...user, notice: [...user.data?.notice || [], newNotice] };\r\n      }\r\n      break;\r\n    case SET_USERS_ONLINE:\r\n      {\r\n        user = { ...user, members: action.members };\r\n      }\r\n      break;\r\n  }\r\n  if (! (user instanceof AltrpUser)) {\r\n    user = new AltrpUser(user);\r\n  }\r\n  if(! window.SSR){\r\n    const rootElement = document.getElementById('front-app');\r\n    if(user.hasRoles('admin')){\r\n      rootElement && rootElement.classList.add('front-app_admin')\r\n    } else{\r\n      rootElement && rootElement.classList.remove('front-app_admin');\r\n    }\r\n  }\r\n  return user;\r\n}\r\n"],"sourceRoot":""}